{"version":3,"sources":["components/CanvasDiagram.tsx","components/Toolbar.tsx","components/AppToolbar.tsx","components/ExportEditor.tsx","components/Icons/Copy.jsx","components/Icons/Cut.jsx","components/Icons/Delete.jsx","components/Icons/Duplicate.jsx","components/Icons/Paste.jsx","components/Icons/Redo.jsx","components/Icons/Settings.jsx","components/Icons/Undo.jsx","components/Icons/ZoomIn.jsx","components/Icons/ZoomOut.jsx","components/ContextMenus/KeyMenu.jsx","components/ContextMenus/ContextMenuIconContainer.jsx","components/ContextMenus/ContextMenuShortcutContainer.jsx","components/ContextMenus/ComponentContextMenu.tsx","components/ContextMenus/DiagramContextMenu.tsx","components/ContextMenus/ContextMenus.tsx","DiagramController/actions/DeleteAction.ts","schemanode/node/SchemaNodeModel.ts","DiagramController/actions/NewNodeAction.ts","DiagramController/actions/DuplicateAction.ts","DiagramController/actions/Clipboard.ts","schemanode/port/SchemaPortLabelWidget.tsx","schemanode/node/SchemaNodeWidget.tsx","schemanode/node/SchemaNodeFactory.tsx","libs/engine.ts","DiagramController/DiagramCtr.tsx","components/Appbar.tsx","components/TableEditor.tsx","components/ContextMenus/SimpleContext.tsx","api/export/MySqlGenerate.ts","api/export/BaseGenerate.ts","reducer/share/type.ts","pages/editor.tsx","interface/project.ts","reducer/share/action.ts","reducer/auth/type.ts","reducer/project/type.ts","libs/tableUtil.ts","interface/user.ts","reducer/auth/action.ts","reducer/project/action.ts","reducer/auth/thunkaction.ts","reducer/loadapp.ts","components/Document/LoginModal.tsx","components/Document/MainHead.tsx","components/Icons/ericon.png","components/Document/FileList.tsx","reducer/project/thunkaction.ts","components/Document/ProjectForm.tsx","pages/document.tsx","App.tsx","reducer/auth/auth.ts","reducer/share/share.ts","reducer/project/project.ts","store/index.ts","index.tsx"],"names":["CT","styled","div","p","background","DemoCanvasWidget","color","id","this","props","children","React","useStyles","makeStyles","theme","createStyles","root","border","palette","divider","borderRadius","shape","backgroundColor","text","secondary","margin","spacing","Toolbar","onSave","onLoad","onZoomIn","onZoomOut","onZoomFit","newTable","classes","Grid","container","alignItems","className","onClick","Divider","orientation","flexItem","Select","MenuItem","value","flexGrow","title","menu","marginRight","menuButton","AppToolbar","onExport","isApiLoading","useSelector","state","ShareReducer","isLoading","style","height","marginLeft","Typography","variant","Button","MenuEnum","LEFT","MenuList","Menu","Right","SqlExport","code","fileName","isRender","onDownloadClick","onInputChange","TextField","label","onChange","multiline","rowsMax","marginTop","width","ImageExport","imageType","ExportEditor","isOpen","onclose","exportPng","exportSql","exportTest","useState","Image","currentMenu","setcurrentMenu","currentFileName","setcurrentFileName","useEffect","handleFileNameInput","e","target","Drawer","anchor","open","onClose","display","role","IconButton","size","MySql","light","Copy","viewBox","fill","stroke","strokeWidth","x","y","rx","ry","d","Cut","cx","cy","r","x1","y1","x2","y2","Delete","points","Duplicate","transform","Paste","Redo","Settings","Undo","ZoomIn","ZoomOut","Container","span","Key","ContextMenuIconContainer","ContextMenuShortcutContainer","ComponentContextMenu","copyFunc","pasteFunc","deleteFunc","duplicateFunc","cutFunc","zoomIn","zoomOut","DiagramContextMenu","redoFunc","undoFunc","ContextMenus","DeleteAction","areShortcutsAllowed","type","InputType","KEY_DOWN","fire","event","console","log","JSON","stringify","engine","getModel","isLocked","matchesInput","preventDefault","handleAction","getSelectedEntities","filter","model","forEach","remove","repaintCanvas","ctrlKey","Action","SchemaNodeModel","options","name","portsIn","portsOut","fieldOptions","lookupTable","clone","getID","i","length","portId","indexof","findIndex","fieldIndex","f","splice","removeField","port","getOptions","in","indexOf","tb","fields_tb","fields","getAllField","fieldName","fieldType","field","portin","addInPort","portout","addOutPort","add","ai","pk","fk","fkTb","fkField","push","removePort","addField","inId","undefined","fieldOption","targetNode","targetIdPort","sourceInIdPort","alert","targetPort","getPortFromID","sourceport","link","reportPosition","portins","rs","getField","index","fieldOptionIndex","outId","after","uid","uuidv4","DefaultPortModel","alignment","PortModelAlignment","addPort","RIGHT","data","_","portsInOrder","portsOutOrder","c","NodeModel","NewNodeAction","snode","setPosition","addAll","DuplicateAction","clones","entity","BaseModel","map","clearSelection","addNode","setSelected","ClipboardAction","handleCut","handleCopy","handlePaste","getSelectedComponents","selectNodes","copie","serialize","localStorage","setItem","Promise","resolve","reject","clipboardstr","getItem","clipboard","parse","pastemodel","deserializeData","registerModel","deserialize","PortLabel","Label","Port","SchemaPortLabel","storeRef","Node","Title","TitleName","Ports","PortsContainer","SchemaNodeWidget","generatePort","getActionEventBus","fireAction","key","stopPropagation","fireEvent","data-default-node-name","node","selected","isSelected","onDoubleClick","fireDoubleClick","fireDeleteEvent","getInPorts","getOutPorts","SchemaNodeFactory","initialConfig","AbstractReactFactory","GetEngine","createEngine","registerDefaultDeleteItemsAction","getNodeFactories","registerFactory","DiagramModel","setModel","DiagramController","isLock","copySelected","duplicateSelected","cutSelected","pasteSelected","deleteSelected","undo","initActions","getEngine","getZoomLevel","links","getLinks","getModels","registerAction","entities","model2","obj","deserializeModel","linkNode","nodes","getNodes","sourcePort","currentNode","targetNodeId","targetNodeField","mainNodeField","getNode","linkForeignKey","updateNode","tablename","zoomLevel","setZoomLevel","addOrUpdateFieldOption","clientX","clientY","deltaY","inputEdit","padding","fontSize","Appbar","onDelete","onEndEdit","isEdit","setisEdit","textInput","settextInput","AppBar","position","elevation","edge","aria-label","onBlur","styledTable","cell","TableEditor","diagramctr","forceUpdate","getNodeData","currentTable","setTable","getOtherTable","otherTable","currentSelectTableId","setcurrentSelectTableId","currentFieldId","setcurrentFieldId","currentField","useMemo","find","t","loadTableFieldSelect","toggleUpdate","settoggleUpdate","currentEdit","setcurrentEdit","typeSelect","settypeSelect","nodedata","tbname","fieldlist","getFieldsData","setEditField","closeEdit","newtb","handleChange","handleTypeChange","onSelectTableChange","onChangeFieldSelect","targetPortOutId","sourceField","sourceFieldId","linkModel","getFieldOption","optionName","setFieldOption","idField","fieldIndexof","newfieldOption","updateFieldOption","updateNodeName","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","row","component","scope","placeholder","o","checked","removeFieldbyId","AddNewField","newField","SimpleContext","MySqlGenerate","isLastLine","newLineAndTab","getFields","getCreateTable","ShareActionType","VisibleStatus","projectToJson","projectName","ProjectName","projectDescription","ProjectDescription","projectDetail","ProjectDetail","user","UserId","visibleStatus","shareUrl","ShareUrl","ToggleLoading","TOGGLE_LOADING","payload","AuthActionType","ProjectActionType","Editor","projectId","useParams","AuthReducer","dispatch","useDispatch","update","setisLogin","diagram","settoggleFileMenu","Private","Id","initProject","currentProject","isExportOpen","setisExportOpen","setEdit","registerListener","ToggleEditor","token","Cookies","get","axios","defaults","headers","common","loaduserAndProject","isLogger","loadProjectDataApi","then","saveDataByString","filename","document","getElementById","htmlToImage","dataUrl","src","a","createElement","href","download","click","catch","error","loadOpenFile","elem","createEvent","evt","initEvent","dispatchEvent","downloadFile","content","setAttribute","encodeURIComponent","body","appendChild","removeChild","doZoom","Fragment","newNode","newproject","api","modelstr","put","exportPdf","codeGen","tbs","getAllTable","str","export","exportSelect","input","reader","FileReader","onload","es","result","readAsText","files","jsonToUser","_id","UserName","userName","UserLastName","userlastname","UserEmail","userEmail","UserPassword","userPassword","SetUser","SET_USER","SetLoginState","SET_LOGIN","SetProject","SET_PROJECT","NewProject","NEW_PROJECT","DeleteProject","DELETE_PROJECT","ToggleModal","TOGGLE_MODAL","signIn","login","post","status","access_token","set","initApp","userUrl","baseUrl","projectUrl","all","spread","userrs","projectrs","projects","project","LoginModal","isLogin","setuserName","setuserPassword","onLogin","loginParam","Modal","header","Form","Field","Checkbox","MainHead","fixed","Item","as","FileList","isConfrimModal","setisConfrimModal","currentSelect","setcurrentSelect","ProjectReducer","List","divided","relaxed","Icon","verticalAlign","Content","floated","to","Header","Description","basic","onOpen","icon","Actions","inverted","url","delete","ProjectForm","setprojectName","setprojectDescription","newProjectAsync","ExTemplate","Document","addProjectModal","Loader","active","Sidebar","Pushable","Segment","direction","vertical","visible","Pusher","path","App","exact","initialState","err","confrimModal","rootReducer","combineReducers","action","UPDATE_USER","TOGGLE_CONFRIM_MODAL","store","createStore","applyMiddleware","thunkMiddleware","configureStore","ReactDOM","render"],"mappings":"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","file":"static/js/main.9b8f5a90.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport styled from '@emotion/styled';\r\n\r\n//import { useSelector } from 'react-redux'\r\n\r\n\r\n\r\nexport interface DemoCanvasWidgetProps {\r\n\tcolor?: string;\r\n\tbackground?: string;\r\n}\r\n\r\nexport const CT = styled.div<{ color: string; background: string }>`\r\ndisplay : flex;\r\njustify-content: center;\r\nbackground-color: ${(p) => p.background};\r\n\r\n\r\n`;\r\n\r\n\texport const Container = styled.div<{ color: string; background: string }>`\r\n\r\n\t\tbackground-color: ${(p) => p.background};\r\n\t\tbackground-size: 50px 50px;\r\n\t\r\n\t\tbackground-image: linear-gradient(\r\n\t\t\t\t0deg,\r\n\t\t\t\ttransparent 24%,\r\n\t\t\t\t${(p) => p.color} 25%,\r\n\t\t\t\t${(p) => p.color} 26%,\r\n\t\t\t\ttransparent 27%,\r\n\t\t\t\ttransparent 74%,\r\n\t\t\t\t${(p) => p.color} 75%,\r\n\t\t\t\t${(p) => p.color} 76%,\r\n\t\t\t\ttransparent 77%,\r\n\t\t\t\ttransparent\r\n\t\t\t),\r\n\t\t\tlinear-gradient(\r\n\t\t\t\t90deg,\r\n\t\t\t\ttransparent 24%,\r\n\t\t\t\t${(p) => p.color} 25%,\r\n\t\t\t\t${(p) => p.color} 26%,\r\n\t\t\t\ttransparent 27%,\r\n\t\t\t\ttransparent 74%,\r\n\t\t\t\t${(p) => p.color} 75%,\r\n\t\t\t\t${(p) => p.color} 76%,\r\n\t\t\t\ttransparent 77%,\r\n\t\t\t\ttransparent\r\n\t\t\t);\r\n\t`;\r\n\r\n\r\nexport class DemoCanvasWidget extends React.Component<DemoCanvasWidgetProps> {\r\n\t//public schemax  = useSelector(getSchema)\r\n\trender() {\r\n\t\t//console.log(this.schemax)\r\n\t\treturn (\r\n\t\t\t<CT id=\"diagramcv\"\r\n\t\t\t\tbackground={this.props.background || 'rgb(60, 60, 60)'}\r\n\t\t\t\tcolor={this.props.color || 'rgba(255,255,255, 0.05)'}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</CT>\r\n\t\t);\r\n\t}\r\n}","import React , {FunctionComponent} from 'react';\r\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\r\nimport Redo from '@material-ui/icons/Redo';\r\nimport Undo from '@material-ui/icons/Undo';\r\nimport FileCopy from '@material-ui/icons/FileCopy';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport LaunchIcon from '@material-ui/icons/Launch';\r\nimport PrintIcon from '@material-ui/icons/Print';\r\nimport ZoomInIcon from '@material-ui/icons/ZoomIn';\r\nimport ZoomOutIcon from '@material-ui/icons/ZoomOut';\r\nimport BookmarksIcon from '@material-ui/icons/Bookmarks';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport TableChartIcon from '@material-ui/icons/TableChart';\r\nimport Select from '@material-ui/core/Select';\r\n\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n\r\n      border: `1px solid ${theme.palette.divider}`,\r\n      borderRadius: theme.shape.borderRadius,\r\n      backgroundColor: '#F1F1F1',\r\n      color: theme.palette.text.secondary,\r\n      '& svg': {\r\n        margin: theme.spacing(1.0),\r\n      },\r\n      '& hr': {\r\n        margin: theme.spacing(0, 0.5),\r\n      },\r\n    },\r\n  }),\r\n);\r\n\r\ninterface ToolbarFunction{\r\n  onZoomIn : () => void,\r\n  onZoomOut : () => void,\r\n  onZoomFit : () => void,\r\n  onSave : () => void,\r\n  onLoad : () => void,\r\n  newTable: () => void\r\n}\r\n\r\nexport const Toolbar: FunctionComponent<ToolbarFunction> = ({onSave , onLoad , onZoomIn , onZoomOut , onZoomFit , newTable }) => {\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div>\r\n      <Grid container alignItems=\"center\" className={classes.root}>\r\n        \r\n          <TableChartIcon onClick={newTable}></TableChartIcon>\r\n          <LaunchIcon></LaunchIcon>\r\n          <FileCopy></FileCopy>\r\n          <PrintIcon></PrintIcon>\r\n          <Divider orientation=\"vertical\" flexItem />\r\n        <Redo />\r\n        <Undo />\r\n        <Divider orientation=\"vertical\" flexItem />\r\n        <Select>\r\n        <MenuItem value={\"50%\"}>50%</MenuItem>\r\n          <MenuItem value={\"75%\"}>75%</MenuItem>\r\n          <MenuItem value={\"100%\"}>100%</MenuItem>\r\n        </Select>\r\n        <ZoomInIcon onClick={onZoomIn} />\r\n        <ZoomOutIcon  onClick={onZoomOut}/>\r\n        <ZoomOutIcon  onClick={onZoomFit}/>\r\n        <Divider orientation=\"vertical\" flexItem />\r\n        <BookmarksIcon onClick={onSave}></BookmarksIcon>\r\n        <DeleteIcon onClick={onLoad}></DeleteIcon>\r\n      </Grid>\r\n    </div>\r\n  );\r\n}","\r\nimport React , {FunctionComponent} from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport Button  from '@material-ui/core/Button';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../store';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      flexGrow: 1,\r\n\r\n    },\r\n    title: {\r\n      flexGrow: 1,\r\n\r\n    },\r\n    menu : {\r\n        marginRight : 10\r\n    },\r\n    menuButton: {\r\n      marginRight: theme.spacing(2),\r\n    },\r\n  }),\r\n);\r\n\r\ninterface ToolbarFunction {\r\n  onExport : () => void,\r\n\r\n}\r\n\r\nexport const AppToolbar: FunctionComponent<ToolbarFunction> = ({onExport }) => {\r\n  const classes = useStyles();\r\n  \r\n  const isApiLoading = useSelector((state : RootState ) => state.ShareReducer.isLoading)\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div style={{height : 30,marginLeft : 20 }}>\r\n \r\n          <Typography variant=\"h6\" color=\"inherit\" >\r\n            Visual Draw\r\n            \r\n          </Typography>\r\n          \r\n      </div>\r\n      <div style={{height : 40}}>\r\n \r\n          \r\n      <Button>File</Button>\r\n          <Button onClick={onExport}>Export</Button>\r\n          <Button> Print</Button>\r\n          <Button>Help</Button>\r\n          <Typography className={classes.title}></Typography>\r\n\r\n          {isApiLoading ? <div>Saving....</div> : \"\"}\r\n   \r\n      </div>\r\n  \r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n","import React, { FunctionComponent, useEffect, useState } from 'react'\r\nimport Drawer from '@material-ui/core/Drawer';\r\n\r\nimport styled from '@emotion/styled';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport HighlightOffIcon from '@material-ui/icons/HighlightOff';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\n\r\n//mongodb+srv://topster:<password>@cluster0.hbfnd.mongodb.net/myFirstDatabase?retryWrites=true&w=majority\r\n//aaebaYCK6opQGeRA\r\n\r\nexport interface TableEditorProp {\r\n  isOpen: boolean,\r\n  onclose: () => void\r\n}\r\n\r\n\r\nexport const LEFT = styled.div<{}>`\r\nwidth : 30%;\r\nheight: 100vh;\r\ncolor : white;\r\nfont-size : 20px;\r\nbackground-color: #005AA0;\r\n`;\r\n\r\nexport const MenuList = styled.div<{}>`\r\n\r\ncolor : white;\r\n\r\npadding : 15px;\r\nmargin-bottom : 10px;\r\n`;\r\n\r\nexport const Menu = styled.div<{}>`\r\n\r\ncolor : white;\r\nfont-size : 15px;\r\nmargin : 8px;\r\n\r\n`;\r\n\r\n\r\nexport const Right = styled.div<{}>`\r\nwidth : 70%;\r\nbackground-color: \"white\";\r\nmargin : 15px;\r\nfont-size : 20px;\r\n\r\n`;\r\n\r\n\r\n\r\n\r\nexport const SqlExport: FunctionComponent<ExportSqlProp> = ({ code, fileName, isRender, onDownloadClick , onInputChange }) => {\r\n  if (!isRender) {\r\n    return (<div></div>)\r\n  } else {\r\n    return (\r\n      <div>\r\n        <div>Export sql</div>\r\n        <TextField label=\"file name\" variant=\"filled\" value={fileName} onChange={onInputChange} />\r\n        <TextField label=\"Filled\" variant=\"filled\" multiline\r\n          rowsMax={20} style={{ marginTop: 20, width: \"100%\", height: 400 }} value={code}  />\r\n        <Button variant=\"outlined\" color=\"primary\" style={{ marginRight: 10 }}>Copy</Button>\r\n        <Button variant=\"contained\" color=\"primary\" onClick={onDownloadClick} >Download</Button>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport const ImageExport: FunctionComponent<ExportImageProp> = ({ fileName, isRender, imageType, onDownloadClick , onInputChange }) => {\r\n  if (!isRender) {\r\n    return (<div></div>)\r\n  } else {\r\n    return (\r\n      <div>\r\n        <div>Export Image</div>\r\n        <TextField label=\"file name\" variant=\"filled\" value={fileName} onChange={onInputChange} />\r\n\r\n        <Button variant=\"contained\" color=\"primary\" onClick={onDownloadClick}  >Download</Button>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nenum MenuEnum {\r\n  Image,\r\n  MySql,\r\n  SqlServer,\r\n  Postresql,\r\n  Laravel\r\n}\r\n\r\n\r\ninterface ExportProp {\r\n  isOpen: boolean,\r\n  fileName : string,\r\n  onclose: () => void,\r\n  exportPng: (filename : string) => void,\r\n  exportPdf: (filename : string) => void,\r\n  exportSql: (filename : string) => void,\r\n  exportTest : (a : string) => void\r\n}\r\n\r\ninterface ExportEvent {\r\n  onclose: () => void,\r\n  exportPng: () => void,\r\n  exportPdf: (filename : string) => void,\r\n  exportSql: (filename : string) => void\r\n}\r\n\r\ninterface MenuExport {\r\n  isRender: boolean,\r\n  fileName: string,\r\n  onInputChange : (e : any) => void,\r\n  onDownloadClick: () => void\r\n}\r\n\r\ninterface ExportImageProp extends MenuExport {\r\n  imageType: string\r\n}\r\n\r\ninterface ExportSqlProp extends MenuExport {\r\n  code: string,\r\n}\r\n\r\nexport const ExportEditor: FunctionComponent<ExportProp> = ({ isOpen, onclose, exportPng,  exportSql , exportTest , fileName}) => {\r\n\r\n  const [currentMenu, setcurrentMenu] = useState(MenuEnum.Image)\r\n\r\n  const [currentFileName, setcurrentFileName] = useState(\"\")\r\n\r\n  useEffect(() => {\r\n    if(isOpen === false){\r\n      setcurrentFileName(fileName)\r\n    }\r\n    \r\n  }, [fileName])\r\n\r\n  const handleFileNameInput = (e : any) => setcurrentFileName(e.target.value)\r\n\r\n  const onExportSql = () => {\r\n    exportSql(currentFileName + \".sql\")\r\n  }\r\n\r\n  const onExportPng = () => {\r\n    exportPng(currentFileName + \".png\")\r\n  }\r\n\r\n  return (\r\n\r\n    <Drawer anchor={\"right\"} open={isOpen} style={{ width: 400 }} onClose={onclose}>\r\n      <div\r\n        style={{ width: 500, display: \"flex\" }}\r\n        role=\"presentation\"\r\n        className=\"\"\r\n      >\r\n\r\n        <LEFT>\r\n          <IconButton color=\"inherit\" size=\"medium\"><HighlightOffIcon></HighlightOffIcon></IconButton>\r\n          <MenuList>\r\n            <Menu onClick={() => setcurrentMenu(MenuEnum.MySql)}>Sql</Menu>\r\n            <Menu onClick={() => setcurrentMenu(MenuEnum.Image)}>Image</Menu>\r\n            <Menu onClick={() => exportTest('filename test')}>Pdf</Menu>\r\n\r\n            <Divider style={{ marginTop: 10, color: \"white\" }} light={true}></Divider>\r\n\r\n            <Menu>Laravel</Menu>\r\n            <Menu>Golang Gin</Menu>\r\n\r\n          </MenuList>\r\n        </LEFT>\r\n        <Right>\r\n          <SqlExport isRender={currentMenu == MenuEnum.MySql}\r\n          onInputChange={handleFileNameInput} code={\"\"} fileName={currentFileName} onDownloadClick={onExportSql} />\r\n          <ImageExport isRender={currentMenu == MenuEnum.Image} \r\n          onInputChange={handleFileNameInput} imageType=\"png\" fileName={currentFileName} onDownloadClick={onExportPng} />\r\n        </Right>\r\n\r\n      </div>\r\n    </Drawer>\r\n  )\r\n}\r\n","import React from 'react';\n\nconst Copy = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={size}\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke={color}\n    strokeWidth=\"2\"\n  >\n    <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\" />\n    <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\" />\n  </svg>\n);\n\nexport default Copy;\n","import React from 'react';\n\nconst Cut = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={size}\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke={color}\n    strokeWidth=\"2\"\n  >\n    <circle cx=\"6\" cy=\"6\" r=\"3\" />\n    <circle cx=\"6\" cy=\"18\" r=\"3\" />\n    <line x1=\"20\" y1=\"4\" x2=\"8.12\" y2=\"15.88\" />\n    <line x1=\"14.47\" y1=\"14.48\" x2=\"20\" y2=\"20\" />\n    <line x1=\"8.12\" y1=\"8.12\" x2=\"12\" y2=\"12\" />\n  </svg>\n);\n\nexport default Cut;\n","import React from 'react';\n\nconst Delete = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={size}\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke={color}\n    strokeWidth=\"2\"\n  >\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n    <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" />\n    <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" />\n  </svg>\n);\n\nexport default Delete;\n","import React from 'react';\n\nconst Duplicate = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={(size * 18) / 24}\n    viewBox=\"0 0 24 18\"\n    fill=\"none\"\n    stroke=\"none\"\n    strokeWidth=\"2\"\n  >\n    <g transform=\"translate(-678.000000, -2727.000000)\">\n      <g transform=\"translate(100.000000, 2626.000000)\">\n        <g transform=\"translate(578.000000, 98.000000)\">\n          <g transform=\"translate(0.000000, 0.000000)\">\n            <polygon points=\"0 0 24 0 24 24 0 24\" />\n            <path\n              d=\"M15,8 C14.45,8 14,8.45 14,9 L14,11 L12,11 C11.45,11 11,11.45 11,12 C11,12.55 11.45,13 12,13 L14,13 L14,15 C14,15.55 14.45,16 15,16 C15.55,16 16,15.55 16,15 L16,13 L18,13 C18.55,13 19,12.55 19,12 C19,11.45 18.55,11 18,11 L16,11 L16,9 C16,8.45 15.55,8 15,8 Z M2,12 C2,9.42 3.4,7.17 5.48,5.96 C5.8,5.77 6.01,5.45 6.01,5.08 C6.01,4.31 5.17,3.83 4.5,4.22 C1.82,5.78 0,8.68 0,12 C0,15.32 1.82,18.22 4.5,19.78 C5.17,20.17 6.01,19.69 6.01,18.92 C6.01,18.55 5.8,18.23 5.48,18.04 C3.4,16.83 2,14.58 2,12 Z M15,3 C10.04,3 6,7.04 6,12 C6,16.96 10.04,21 15,21 C19.96,21 24,16.96 24,12 C24,7.04 19.96,3 15,3 Z M15,19 C11.14,19 8,15.86 8,12 C8,8.14 11.14,5 15,5 C18.86,5 22,8.14 22,12 C22,15.86 18.86,19 15,19 Z\"\n              fill={color}\n            />\n          </g>\n        </g>\n      </g>\n    </g>\n  </svg>\n);\n\nexport default Duplicate;\n","import React from 'react';\n\nconst Paste = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={size}\n    fill={color}\n    viewBox=\"0 0 512.001 512.001\"\n  >\n    <g>\n      <g>\n        <g>\n          <path\n            d=\"M481,371c11.046,0,20-8.954,20-20v-92c0-33.084-26.916-60-60-60h-39v-79c0-44.112-35.888-80-80-80h-47.533\n\t\t\t\tc-7.739-23.749-29.864-40-55.16-40h-25.614c-25.296,0-47.421,16.251-55.16,40H91c-44.112,0-80,35.888-80,80v312\n\t\t\t\tc0,44.112,35.888,80,80,80h88c11.046,0,20-8.954,20-20c0-11.046-8.954-20-20-20H91c-22.056,0-40-17.944-40-40V120\n\t\t\t\tc0-22.056,17.944-40,40-40h2v59c0,11.046,8.954,20,20,20h189c11.046,0,20-8.954,20-20V80c22.056,0,40,17.944,40,40v79h-65.007\n\t\t\t\tC263.914,199,237,225.913,237,258.993v193.015c0,33.08,26.916,59.993,60.01,59.993L441,511.926c33.084,0,60-26.913,60-59.992\n\t\t\t\tc0-11.046-8.954-20-20-20c-11.046,0-20,8.954-20,20c0,11.024-8.972,19.992-20.01,19.992L297,472c-11.028,0-20-8.969-20-19.993\n\t\t\t\tV258.993c0-11.024,8.969-19.993,19.993-19.993H441c11.028,0,20,8.972,20,20v92C461,362.046,469.955,371,481,371z M282,119H133V80\n\t\t\t\th21c9.177,0,17.177-6.246,19.403-15.149l2.798-11.194C178.211,45.616,185.404,40,193.693,40h25.614\n\t\t\t\tc8.289,0,15.481,5.616,17.492,13.657l2.798,11.194C241.823,73.754,249.823,80,259,80h23V119z\"\n          />\n          <path\n            d=\"M401,279h-64c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h64c11.046,0,20-8.954,20-20\n\t\t\t\tC421,287.954,412.047,279,401,279z\"\n          />\n          <path\n            d=\"M401,349h-64c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h64c11.046,0,20-8.954,20-20\n\t\t\t\tC421,357.954,412.047,349,401,349z\"\n          />\n        </g>\n      </g>\n    </g>\n  </svg>\n);\n\nexport default Paste;\n","import React from 'react';\n\nconst Redo = ({ size = 16, color = 'gray' }) => (\n  <svg width={size} height={size} viewBox=\"0 0 512 512\" fill={color}>\n    <path d=\"m431 481c0 11.046-8.954 20-20 20h-66c-11.046 0-20-8.954-20-20s8.954-20 20-20h66c11.046 0 20 8.954 20 20zm63.358-352.994-112.284-111.215c-7.848-7.773-20.511-7.713-28.284.135s-7.712 20.511.135 28.284l106.808 105.79h-285.733c-96.495 0-175 78.505-175 175s78.505 175 175 175h69c11.046 0 20-8.954 20-20s-8.954-20-20-20h-69c-74.439 0-135-60.561-135-135s60.561-135 135-135h284.836l-105.037 105.917c-7.778 7.843-7.725 20.506.118 28.284 3.9 3.868 8.992 5.799 14.083 5.799 5.146 0 10.292-1.975 14.202-5.917l111.225-112.157c11.332-11.332 17.573-26.4 17.573-42.426s-6.241-31.094-17.642-42.494z\" />\n  </svg>\n);\n\nexport default Redo;\n","import React from 'react';\n\nconst Settings = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={size}\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke={color}\n    strokeWidth=\"2\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\n  </svg>\n);\n\nexport default Settings;\n","import React from 'react';\n\nconst Undo = ({ size = 16, color = 'gray' }) => (\n  <svg width={size} height={size} viewBox=\"0 0 512 512\" fill={color}>\n    <path d=\"m 81,481 c 0,11.046 8.954,20 20,20 h 66 c 11.046,0 20,-8.954 20,-20 0,-11.046 -8.954,-20 -20,-20 h -66 c -11.046,0 -20,8.954 -20,20 z M 17.642,128.006 129.926,16.791 c 7.848,-7.773 20.511,-7.713 28.284,0.135 7.773,7.848 7.712,20.511 -0.135,28.284 L 51.267,151 H 337 c 96.495,0 175,78.505 175,175 0,96.495 -78.505,175 -175,175 h -69 c -11.046,0 -20,-8.954 -20,-20 0,-11.046 8.954,-20 20,-20 h 69 c 74.439,0 135,-60.561 135,-135 0,-74.439 -60.561,-135 -135,-135 H 52.164 l 105.037,105.917 c 7.778,7.843 7.725,20.506 -0.118,28.284 -3.9,3.868 -8.992,5.799 -14.083,5.799 -5.146,0 -10.292,-1.975 -14.202,-5.917 L 17.573,212.926 C 6.241,201.594 0,186.526 0,170.5 0,154.474 6.241,139.406 17.642,128.006 Z\" />\n  </svg>\n);\n\nexport default Undo;\n","import React from 'react';\n\nconst ZoomIn = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={size}\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke={color}\n    strokeWidth=\"2\"\n  >\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n    <line x1=\"11\" y1=\"8\" x2=\"11\" y2=\"14\" />\n    <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" />\n  </svg>\n);\n\nexport default ZoomIn;\n","import React from 'react';\n\nconst ZoomOut = ({ size = 16, color = 'gray' }) => (\n  <svg\n    width={size}\n    height={size}\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke={color}\n    strokeWidth=\"2\"\n  >\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n    <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" />\n  </svg>\n);\n\nexport default ZoomOut;\n","import React from 'react';\r\n\r\nimport styled from '@emotion/styled';\r\n\r\nconst Container = styled.span`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  height: ${props => props.size}px;\r\n  padding: 0 ${props => props.size / 4}px;\r\n  margin: 2px ${props => props.size / 8}px;\r\n  font-size: ${props => props.size / 2}px;\r\n  font-family: monospace;\r\n  color: #000000c4;\r\n  background: #ececec;\r\n  border-radius: 4px;\r\n  border: 1px solid #ffffff17;\r\n  box-shadow: inset 0 0 ${props => props.size / 4}px #0000000a;\r\n`;\r\n\r\nconst Key = ({ children, size = 16 }) => (\r\n  <Container size={size}>{children}</Container>\r\n);\r\n\r\nexport default Key;","\r\nimport styled from '@emotion/styled';\r\nconst ContextMenuIconContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  width: 16px;\r\n  height: 16px;\r\n  margin-right: 16px;\r\n`;\r\n\r\nexport default ContextMenuIconContainer;","import styled from '@emotion/styled';\r\n\r\nconst ContextMenuShortcutContainer = styled.div`\r\n  display: flex;\r\n  flex: 1;\r\n  justify-content: flex-end;\r\n  margin-left: 8px;\r\n`;\r\n\r\nexport default ContextMenuShortcutContainer;","import React , {FunctionComponent} from 'react';\r\n\r\nimport { Menu, Item, Separator } from 'react-contexify';\r\n\r\nimport {\r\n  Duplicate,\r\n  Copy,\r\n  Delete,\r\n  Paste,\r\n  Redo,\r\n  Settings,\r\n  Undo,\r\n  Cut,\r\n  ZoomIn,\r\n  ZoomOut,\r\n} from '../Icons';\r\nimport Key from './KeyMenu';\r\nimport ContextMenuIconContainer from './ContextMenuIconContainer';\r\nimport ContextMenuShortcutContainer from './ContextMenuShortcutContainer';\r\nimport {ComponentFunction} from './FunctionList'\r\n\r\n  export const ComponentContextMenu : FunctionComponent<ComponentFunction> = ({copyFunc , pasteFunc , deleteFunc , duplicateFunc , cutFunc , zoomIn , zoomOut} ) => (\r\n  <Menu id=\"component\">\r\n    <Item onClick={duplicateFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Duplicate />\r\n      </ContextMenuIconContainer>\r\n      Duplicate\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>D</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Item onClick={cutFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Cut />\r\n      </ContextMenuIconContainer>\r\n      Cut\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>X</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Item onClick={copyFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Copy />\r\n      </ContextMenuIconContainer>\r\n      Copy\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>C</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Item onClick={pasteFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Paste />\r\n      </ContextMenuIconContainer>\r\n      Paste\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>V</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Item onClick={deleteFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Delete />\r\n      </ContextMenuIconContainer>\r\n      Delete\r\n      <ContextMenuShortcutContainer>\r\n        <Key>Delete</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Separator />\r\n\r\n    <Item onClick={zoomIn}>\r\n      <ContextMenuIconContainer>\r\n        <ZoomIn />\r\n      </ContextMenuIconContainer>\r\n      Zoom in\r\n    </Item>\r\n\r\n    <Item onClick={zoomOut}>\r\n      <ContextMenuIconContainer>\r\n        <ZoomOut />\r\n      </ContextMenuIconContainer>\r\n      Zoom out\r\n    </Item>\r\n\r\n    <Separator />\r\n\r\n    <Item onClick={pasteFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Undo />\r\n      </ContextMenuIconContainer>\r\n      Undo\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>Z</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Item onClick={pasteFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Redo />\r\n      </ContextMenuIconContainer>\r\n      Redo\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>SHIFT</Key>\r\n        <Key>Z</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Separator />\r\n\r\n    <Item\r\n     \r\n    >\r\n      <ContextMenuIconContainer>\r\n        <Settings />\r\n      </ContextMenuIconContainer>\r\n      Edit configurations...\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>E</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n  </Menu>\r\n);\r\n\r\nexport default ComponentContextMenu;","import React , {FunctionComponent} from 'react';\r\n\r\nimport { Menu, Item, Separator } from 'react-contexify';\r\n\r\nimport { Redo, Undo, Paste, ZoomIn, ZoomOut } from '../Icons';\r\nimport Key from './KeyMenu';\r\nimport ContextMenuIconContainer from './ContextMenuIconContainer';\r\nimport ContextMenuShortcutContainer from './ContextMenuShortcutContainer';\r\n\r\nimport {ContextFunction} from './FunctionList'\r\n\r\n\r\nexport const DiagramContextMenu : FunctionComponent<ContextFunction> = ({zoomIn , zoomOut , \r\n  pasteFunc , redoFunc , undoFunc} ) => (\r\n  <Menu id=\"diagram\">\r\n    <Item onClick={pasteFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Paste />\r\n      </ContextMenuIconContainer>\r\n      Paste\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>V</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Separator />\r\n\r\n    <Item onClick={zoomIn}>\r\n      <ContextMenuIconContainer>\r\n        <ZoomIn />\r\n      </ContextMenuIconContainer>\r\n      Zoom in\r\n    </Item>\r\n    <Item onClick={zoomOut}>\r\n      <ContextMenuIconContainer>\r\n        <ZoomOut />\r\n      </ContextMenuIconContainer>\r\n      Zoom out\r\n    </Item>\r\n\r\n    <Separator />\r\n\r\n    <Item onClick={undoFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Undo />\r\n      </ContextMenuIconContainer>\r\n      Undo\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>Z</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n\r\n    <Item onClick={redoFunc}>\r\n      <ContextMenuIconContainer>\r\n        <Redo />\r\n      </ContextMenuIconContainer>\r\n      Redo\r\n      <ContextMenuShortcutContainer>\r\n        <Key>CTRL</Key>\r\n        <Key>SHIFT</Key>\r\n        <Key>Z</Key>\r\n      </ContextMenuShortcutContainer>\r\n    </Item>\r\n  </Menu>\r\n);\r\n\r\nexport default DiagramContextMenu;","import React , {FunctionComponent} from 'react';\r\n\r\nimport {ComponentContextMenu} from './ComponentContextMenu';\r\nimport {DiagramContextMenu} from './DiagramContextMenu';\r\n\r\nimport 'react-contexify/dist/ReactContexify.min.css';\r\nimport {AllContextFunction} from './FunctionList'\r\n\r\n\r\n\r\nexport const ContextMenus: FunctionComponent<AllContextFunction> = ({copyFunc , deleteFunc , duplicateFunc , cutFunc , pasteFunc , zoomIn , zoomOut} ) => {\r\n\r\n  return (\r\n    <>\r\n    <DiagramContextMenu  pasteFunc={pasteFunc} zoomIn={zoomIn} zoomOut={zoomOut}  />\r\n    <ComponentContextMenu  copyFunc={copyFunc} pasteFunc={pasteFunc} \r\n    deleteFunc={deleteFunc} duplicateFunc={duplicateFunc} cutFunc={cutFunc} zoomIn={zoomIn} zoomOut={zoomOut} />\r\n  </>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n","\nimport {Action, InputType, BaseModel } from '@projectstorm/react-canvas-core';\n\n\n/**\n * Handles delete actions.\n */\nexport default class DeleteAction extends Action {\n  constructor(areShortcutsAllowed : boolean) {\n    super({\n      type: InputType.KEY_DOWN,\n      fire: ({ event }) => {\n        console.log(JSON.stringify(event))\n        //if (!areShortcutsAllowed) return;\n        if (this.engine.getModel().isLocked()) return;\n        \n        if (this.matchesInput(event)) {\n          event.preventDefault();\n          this.handleAction();\n        }\n      },\n    });\n  }\n\n  matchesInput(event : any) : boolean{\n    return event.ctrlKey && event.code === 'Delete'\n  }\n\n  handleAction = () => {\n    console.log(\"delete\")\n    const entities = this.engine\n      .getModel()\n      .getSelectedEntities()\n      .filter(model => !model.isLocked());\n\n    //this.fireEvent(entities);\n\n    entities.forEach(model => model.remove());\n\n    this.engine.repaintCanvas();\n  };\n\n \n}\n","import * as _ from 'lodash';\r\nimport { NodeModel, NodeModelGenerics, PortModel, PortModelAlignment } from '@projectstorm/react-diagrams-core';\r\nimport { SchemaPortModel } from '../port/SchemaPortModel';\r\nimport { BasePositionModelOptions, DeserializeEvent } from '@projectstorm/react-canvas-core';\r\nimport { DefaultLinkModel, DefaultPortModel, DiagramEngine, LinkModel } from '@projectstorm/react-diagrams';\r\nimport { TableData  } from '../../components/TableEditor';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nexport interface DefaultNodeModelOptions extends BasePositionModelOptions {\r\n\tname?: string;\r\n\tcolor?: string;\r\n}\r\n\r\nexport interface Field{\r\n\tinId ?: string,\r\n\toutId ?: string,\r\n\tfieldName : string,\r\n\tfieldType : string,\r\n\tfieldOption ?: FieldOption\r\n}\r\n\r\nexport interface FieldOption {\r\n\tportId : string,\r\n\tai ?: boolean\r\n\tpk ?: boolean,\r\n\tfk ?: boolean,\r\n\tfkTb ?: string,\r\n\tfkField ?: string\r\n}\r\n\r\nexport interface SchemaNodeModelGenerics extends NodeModelGenerics {\r\n\tOPTIONS: DefaultNodeModelOptions;\r\n}\r\n\r\nexport class SchemaNodeModel extends NodeModel<SchemaNodeModelGenerics> {\r\n\tprotected portsIn: DefaultPortModel[];\r\n\tprotected portsOut: DefaultPortModel[];\r\n\tprotected fieldOptions : FieldOption[]\t\r\n\r\n\tconstructor(name: string, color: string);\r\n\tconstructor(options?: DefaultNodeModelOptions);\r\n\tconstructor(options: any = {}, color?: string) {\r\n\t\tif (typeof options === 'string') {\r\n\t\t\toptions = {\r\n\t\t\t\tname: options,\r\n\t\t\t\tcolor: color\r\n\t\t\t};\r\n\t\t}\r\n\t\tsuper({\r\n\t\t\ttype: 'default',\r\n\t\t\tname: 'Untitled',\r\n\t\t\tcolor: 'rgb(0,192,255)',\r\n\t\t\t...options\r\n\t\t});\r\n\t\tthis.portsOut = [];\r\n\t\tthis.portsIn = [];\r\n\t\tthis.fieldOptions = []\r\n\t}\r\n\r\n\tperformanceTune() : boolean { return false}\r\n\r\n\tdoClone(lookupTable: {}, clone: SchemaNodeModel): void {\r\n\r\n\t\tconsole.log('original id : ' + this.getID())\r\n\t\tclone.portsIn = [];\r\n\t\tclone.portsOut = [];\r\n\t\t\r\n\t\tsuper.doClone(lookupTable, clone);\r\n\t\tlet fields = []\r\n\t\tfor (let i = 0; i < clone.portsIn.length; i++) {\r\n\t\t\tclone.fieldOptions[i].portId = clone.portsIn[i].getID()\r\n\t\t}\r\n\t}\r\n\r\n\tremoveFieldbyId(id : string): void{\r\n\t\t\r\n\t\tlet indexof = this.portsIn.findIndex(p=>p.getID() == id );\r\n\r\n\t\tlet fieldIndex = this.fieldOptions.findIndex(f=>f.portId == id)\r\n\r\n\t\tif(indexof === -1) return\r\n\r\n\t\tif(fieldIndex !== -1){\r\n\t\t\tthis.fieldOptions.splice(fieldIndex, 1);\r\n\t\t}\r\n\r\n\t\tthis.removeField(indexof)\r\n\t}\r\n\r\n\tremovePort(port: DefaultPortModel): void {\r\n\t\tsuper.removePort(port);\r\n\t\r\n\t\tif (port.getOptions().in) {\r\n\t\t\tthis.portsIn.splice(this.portsIn.indexOf(port), 1);\r\n\t\t} else {\r\n\t\t\tthis.portsOut.splice(this.portsOut.indexOf(port), 1);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateNode(tb : TableData){\r\n\t\r\n\t\tlet fields_tb = tb.fields\r\n\t\tlet fields = this.getAllField()\r\n\t\tfor (let i = 0; i < fields_tb.length; i++) {\r\n\t\t\tif(fields[i].fieldName !== fields_tb[i].fieldName){\r\n\t\t\t\tthis.portsIn[i].getOptions().label = fields_tb[i].fieldName\r\n\t\t\t}\r\n\t\t\tif(fields[i].fieldType !== fields_tb[i].fieldType){\r\n\t\t\t\tthis.portsOut[i].getOptions().label = fields_tb[i].fieldType\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\r\n\taddField(field : Field) : DefaultPortModel[] {\r\n\t\t\r\n\t\tlet portin = this.addInPort(field.fieldName)\r\n\t\tlet portout = this.addOutPort(field.fieldType)\r\n\t\t\r\n\t\tlet add : FieldOption = {\r\n\t\t\tportId : portin.getID(),\r\n\t\t\tai : false,\r\n\t\t\tpk : false,\r\n\t\t\tfk : false,\r\n\t\t\tfkTb : \"\",\r\n\t\t\tfkField : \"\"\r\n\t\t}\r\n\r\n\t\tthis.fieldOptions.push(add)\r\n\r\n\t\treturn [portin , portout]\r\n\t}\r\n\r\n\tremoveField(i : number){\r\n\r\n\t\tthis.removePort(this.portsIn[i])\r\n\t\tthis.removePort(this.portsOut[i])\r\n\t}\r\n\r\n\tAddNewField(){\r\n\r\n\t\tlet field : Field = {\r\n\t\t\tfieldName : \"test\",\r\n\t\t\tfieldType : \"int\"\r\n\t\t}\r\n\t\tthis.addField(field)\r\n\r\n\t}\r\n\r\n\taddOrUpdateFieldOption(field : Field)  : void{\r\n\t\tlet fieldIndex = this.fieldOptions.findIndex(f=>f.portId === field.inId)\r\n\t\tif(fieldIndex === -1) return\r\n\t\t\r\n\t\tif(field.fieldOption === undefined) return \r\n\t\tthis.fieldOptions[fieldIndex] = field.fieldOption\r\n\t\tconsole.log(field.fieldOption)\r\n\r\n\t\t//fieldrs.\r\n\t\tlet fieldOption = field.fieldOption\r\n\t\tif(fieldOption == undefined) return\r\n\t\t\r\n\t\tlet targetNodeId = (fieldOption.fkTb === undefined) ? \"\" : fieldOption.fkTb\r\n\t\tlet targetPortId = (fieldOption.fkField === undefined) ? \"\" : fieldOption.fkField\r\n\t\tlet sourceIdPort = (field.inId === undefined) ? \"\" : field.inId\r\n\t\t\r\n\t\t//this.linkForeignKey(targetNodeId , targetPortId ,  sourceIdPort)\r\n\t}\r\n\r\n\tlinkForeignKey(targetNode : SchemaNodeModel ,targetIdPort : string , sourceInIdPort : string): LinkModel | undefined{\r\n\t\talert('do link')\r\n\t\tlet targetPort = targetNode.getPortFromID(targetIdPort) as DefaultPortModel\r\n\t\tlet sourceport = this.getPortFromID(sourceInIdPort)  as DefaultPortModel  // find  sourePort\r\n\t\tif(sourceport === null) return undefined\r\n\t\tif(targetPort === null) return undefined\r\n\t\talert('complete link')\r\n\t\tconsole.log(\"main field \" + sourceport.getOptions().label + \" link with : \" + targetPort.getOptions().label)\r\n\t\tconsole.log(sourceport.getOptions().in)\r\n\t\tconsole.log(targetPort.getOptions().in)\r\n\t\tlet link =  targetPort.link(sourceport)\r\n\r\n\t\ttargetPort.reportPosition()\r\n\t\tsourceport.reportPosition()\r\n\t\treturn link\r\n\t}\r\n\r\n\tgetAllField() : Field[]{\r\n\t\tlet portins = this.portsIn\r\n\t\tlet portouts = this.portsOut\r\n\t\tlet rs : Field[] = []\r\n\t\tconsole.log(\"get field lenght : \"+ portins.length)\r\n\r\n\t\tconsole.log(this.fieldOptions)\r\n\r\n\t\tfor (let i = 0; i < portins.length; i++) {\r\n\t\t\tconsole.log(\"check field \" + i )\r\n\t\t\t\r\n\t\t\tlet f = this.getField(i)\r\n\t\t\tconsole.log(f)\r\n\t\t\trs.push(f)\r\n\t\t}\r\n\t\treturn rs\r\n\t}\r\n\r\n\tgetField(index : number) : Field{\r\n\r\n\t\tlet field = this.portsIn[index].getOptions().label\r\n\t\tlet type = this.portsOut[index].getOptions().label\r\n\t\tlet id = this.portsIn[index].getID()\r\n\t\tconsole.log(\"check id : \" + id)\r\n\t\t\r\n\t\tlet fieldOptionIndex = this.fieldOptions.findIndex(f=>f.portId === id)\r\n\r\n\t\tconsole.log(\"fieldopt index : \" + fieldOptionIndex)\r\n\r\n\t\tif(fieldOptionIndex === -1){\r\n\t\t\tlet r : Field = {\r\n\t\t\t\tinId : '',\r\n\t\t\toutId : '',\r\n\t\t\tfieldName : '',\r\n\t\t\tfieldType : '',\r\n\t\r\n\t\t\t}\r\n\t\t\treturn r\r\n\t\t}\r\n\r\n\t\tlet fieldOption = this.fieldOptions[fieldOptionIndex]\r\n\t\tconsole.log(\"field name : \" + field + \" pk : \" + fieldOption.pk + \" fk : \" + fieldOption.fk)\r\n\r\n\t\tif(field === undefined) field = \"\"\r\n\t\tif(type === undefined) type = \"\"\r\n\r\n\t\t\r\n\t\tlet rs : Field = {\r\n\t\t\tinId : this.portsIn[index].getID(),\r\n\t\t\toutId : this.portsOut[index].getID(),\r\n\t\t\tfieldName : field,\r\n\t\t\tfieldType : type,\r\n\t\t\tfieldOption : fieldOption\r\n\t\t}\r\n\r\n\t\treturn rs\r\n\t}\r\n\r\n\tupdatePort(port: SchemaPortModel , index : number){\r\n\t\t\r\n\t}\r\n\r\n\taddPort<T extends DefaultPortModel>(port: T): T {\r\n\r\n\r\n\t\tsuper.addPort(port);\r\n\t\t\r\n\t\tif (port.getOptions().in) {\r\n\t\t\tif (this.portsIn.indexOf(port) === -1) {\r\n\t\t\t\tthis.portsIn.push(port);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.portsOut.indexOf(port) === -1) {\r\n\t\t\t\tthis.portsOut.push(port);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn port;\r\n\t}\r\n\r\n\taddInPort(label: string, after = true): DefaultPortModel {\r\n\t\tlet uid = uuidv4()\r\n\t\tconst p = new DefaultPortModel({\r\n\t\t\tin: true,\r\n\t\t\tname: uid,\r\n\t\t\tlabel: label,\r\n\t\t\talignment: PortModelAlignment.LEFT\r\n\t\t});\r\n\t\tif (!after) {\r\n\t\t\tthis.portsIn.splice(0, 0, p);\r\n\t\t}\r\n\t\treturn this.addPort(p);\r\n\t}\r\n\r\n\taddOutPort(label: string, after = true): DefaultPortModel {\r\n\t\tlet uid = uuidv4()\r\n\t\tconst p = new DefaultPortModel({\r\n\t\t\tin: false,\r\n\t\t\tname: uid,\r\n\t\t\tlabel: label,\r\n\t\t\talignment: PortModelAlignment.RIGHT\r\n\t\t});\r\n\t\tif (!after) {\r\n\t\t\tthis.portsOut.splice(0, 0, p);\r\n\t\t}\r\n\t\treturn this.addPort(p);\r\n\t}\r\n\r\n\t//when convert back to model it is no function to add field and add fieldoption : \r\n\t//fix you need \r\n\r\n\tdeserialize(event: DeserializeEvent<this>) {\r\n\t\tsuper.deserialize(event);\r\n\r\n\t\tthis.options.name = event.data.name;\r\n\t\tthis.options.color = event.data.color;\r\n\t\tthis.fieldOptions = event.data.fields\r\n\t\tconsole.log(this.fieldOptions)\r\n\t\tthis.portsIn = _.map(event.data.portsInOrder, (id : any) => {\r\n\t\t\treturn this.getPortFromID(id);\r\n\t\t}) as DefaultPortModel[];\r\n\t\tthis.portsOut = _.map(event.data.portsOutOrder, (id : any) => {\r\n\t\t\treturn this.getPortFromID(id);\r\n\t\t}) as DefaultPortModel[];\r\n\t\tconsole.log(\"deserial call on shemaModel\")\r\n\r\n\t\tconsole.log(\"after deserial\")\r\n\r\n\t}\r\n\r\n\tdeserializeFieldOption(){\r\n\r\n\t}\r\n\r\n\tserializeClone(c : any){\r\n\t\tconsole.log('serial clone')\r\n\t\tconsole.log(c)\r\n\t}\r\n\r\n\tserialize(): any {\r\n\r\n\t\tconsole.log(\"call serialize on model\")\r\n\r\n\t\tlet fields = []\r\n\r\n\t\tconsole.log(this.fieldOptions)\r\n\r\n\t\tfor (let i = 0; i < this.portsIn.length; i++) {\r\n\t\t\t\r\n\t\t\tlet fieldOptionIndex = this.fieldOptions.findIndex(f=>f.portId === this.portsIn[i].getID())\r\n\t\t\tconsole.log(\"fieldOptIndex : \" + fieldOptionIndex)\r\n\t\t\tif(fieldOptionIndex === -1) continue\r\n\t\t\tfields.push({\r\n\t\t\t\tportId : this.portsIn[i].getID(),\r\n\t\t\t\tfieldName : this.portsIn[i].getOptions().label,\r\n\t\t\t\tfieldType : this.portsOut[i].getOptions().label,\r\n\t\t\t\tai : this.fieldOptions[fieldOptionIndex].ai,\r\n\t\t\t\tpk : this.fieldOptions[fieldOptionIndex].pk\r\n\t\t\t})\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t\r\n\t\treturn {\r\n\t\t\t...super.serialize(),\r\n\t\t\tname: this.options.name,\r\n\t\t\tcolor: this.options.color,\r\n\t\t\tfields : fields,\r\n\t\t\tportsInOrder: _.map(this.portsIn, (port) => {\r\n\t\t\t\treturn port.getID();\r\n\t\t\t}),\r\n\t\t\tportsOutOrder: _.map(this.portsOut, (port) => {\r\n\t\t\t\treturn port.getID();\r\n\t\t\t})\r\n\t\t};\r\n\t}\r\n\r\n\ttoJson() : any{\r\n\t\t\r\n\t\tlet fields = []\r\n\t\tfor (let i = 0; i < this.portsIn.length; i++) {\r\n\t\t\tlet fieldOptionIndex = this.fieldOptions.findIndex(f=>f.portId === this.portsIn[i].getID())\r\n\t\t\tif(fieldOptionIndex === -1) continue\r\n\t\t\tlet field = {\r\n\t\t\t\tfieldName : this.portsIn[i].getOptions().label,\r\n\t\t\t\tfieldType : this.portsOut[i].getOptions().label,\r\n\t\t\t\tfieldOption : this.fieldOptions[fieldOptionIndex]\r\n\t\t\t}\r\n\t\t\tfields.push(field)\r\n\t\t}\r\n\t\tlet rs = {\r\n\t\t\tname : this.options.name,\r\n\t\t\tcolor : this.options.color,\r\n\t\t\tfields : fields\r\n\t\t}\r\n\t\treturn rs\r\n\t}\r\n\r\n\tgetInPorts(): DefaultPortModel[] {\r\n\t\treturn this.portsIn;\r\n\t}\r\n\r\n\tgetOutPorts(): DefaultPortModel[] {\r\n\t\treturn this.portsOut;\r\n\t}\r\n\r\n\t\r\n}","import { DiagramModel, LinkModel, NodeModel } from '@projectstorm/react-diagrams';\r\n\r\nimport { Action, InputType } from '@projectstorm/react-canvas-core';\r\n\r\nimport {BaseModel} from '@projectstorm/react-canvas-core';\r\nimport { SchemaNodeModel } from '../../schemanode/node/SchemaNodeModel';\r\n\r\n/**\r\n * Handle duplication (clone) actions.\r\n */\r\nexport default class NewNodeAction extends Action {\r\n  constructor(areShortcutsAllowed : boolean) {\r\n    super({\r\n      type: InputType.KEY_DOWN,\r\n      fire: ({ event }) => {\r\n        if (!areShortcutsAllowed) return;\r\n        if (this.engine.getModel().isLocked()) return;\r\n\r\n        if (this.matchesInput(event)) {\r\n          event.preventDefault();\r\n          this.handleAction();\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  matchesInput(event : any) : boolean{\r\n    return event.ctrlKey && event.code === 'KeyB'\r\n  }\r\n\r\n  handleAction = () => {\r\n     \r\n    let snode =  new SchemaNodeModel({\r\n\t\tname: 'Product',\r\n\t\tcolor: 'rgb(0,192,255)'\r\n\t});\r\n    snode.addField({fieldName : \"Id\" , fieldType : \"int\"})\r\n\r\n    snode.setPosition(100, 100);\r\n\r\n    let model = this.engine.getModel() as DiagramModel\r\n\r\n    model.addAll(snode)\r\n\r\n    //this.engine.fireEvent({ nodes: clones }, 'componentsAdded');\r\n\r\n    this.engine.repaintCanvas();\r\n  };\r\n}\r\n","import { DiagramModel, LinkModel, NodeModel } from '@projectstorm/react-diagrams';\n\nimport { Action, InputType } from '@projectstorm/react-canvas-core';\n\nimport {BaseModel} from '@projectstorm/react-canvas-core';\n\n/**\n * Handle duplication (clone) actions.\n */\nexport default class DuplicateAction extends Action {\n  constructor(areShortcutsAllowed : boolean) {\n    super({\n      type: InputType.KEY_DOWN,\n      fire: ({ event }) => {\n        if (!areShortcutsAllowed) return;\n        if (this.engine.getModel().isLocked()) return;\n\n        if (this.matchesInput(event)) {\n          event.preventDefault();\n          this.handleAction();\n        }\n      },\n    });\n  }\n\n  matchesInput(event : any) : boolean{\n    return event.ctrlKey && event.code === 'KeyD'\n  }\n\n  handleAction = () => {\n    const model = this.engine.getModel() as DiagramModel\n\n    const clones : BaseModel[] = model \n      .getSelectedEntities()\n      .filter(entity => entity instanceof BaseModel)\n      .filter(entity => !entity.isLocked())\n      .map(entity => entity.clone());\n\n    model.clearSelection();\n\n    clones.forEach(clone => {\n\n      if (clone instanceof NodeModel) {\n        model.addNode(clone)\n        clone.setSelected(true);\n      }\n      \n      \n    });\n\n    //this.engine.fireEvent({ nodes: clones }, 'componentsAdded');\n\n    this.engine.repaintCanvas();\n  };\n}\n","import { Action, InputType , DeserializeEvent } from '@projectstorm/react-canvas-core';\r\n\r\nimport {BaseModel} from '@projectstorm/react-canvas-core';\r\nimport { DiagramModel, NodeModel } from '@projectstorm/react-diagrams';\r\n\r\nimport { SchemaNodeModel } from '../../schemanode/node/SchemaNodeModel';\r\n\r\n\r\n/**\r\n * Handles clipboard actions.\r\n */\r\nexport default class ClipboardAction extends Action {\r\n  constructor(areShortcutsAllowed : boolean) {\r\n    super({\r\n      type: InputType.KEY_DOWN,\r\n      fire: ({ event }) => {\r\n        if (!areShortcutsAllowed) return;\r\n        if (this.engine.getModel().isLocked()) return;\r\n\r\n        if (this.matchesInput(event)) {\r\n          event.preventDefault();\r\n\r\n          const e : any = event;\r\n          if (e.code === 'KeyX') this.handleCut();\r\n          if (e.code === 'KeyC') this.handleCopy();\r\n          if (e.code === 'KeyV') this.handlePaste();\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  matchesInput(event : any) : boolean{\r\n        return event.ctrlKey && (event.code === 'KeyX' || event.code === \"KeyC\" || \r\n        event.code === \"KeyV\")     \r\n  }\r\n\r\n  getSelectedComponents = () =>\r\n    this.engine\r\n      .getModel()\r\n      .getSelectedEntities()\r\n      .filter(entity => entity instanceof SchemaNodeModel)\r\n      .filter(entity => !entity.isLocked());\r\n\r\n  /** Cut */\r\n  handleCut() {\r\n    let selectNodes = this.getSelectedComponents() as SchemaNodeModel[]\r\n    let clonenode = selectNodes[0].clone()\r\n    const copie = clonenode.serialize()\r\n\r\n    localStorage.setItem('clipboard', JSON.stringify(copie));\r\n\r\n    selectNodes.forEach(model => model.remove());\r\n\r\n    this.engine.repaintCanvas();\r\n\r\n  };\r\n\r\n  /** Copy */\r\n  handleCopy() {\r\n    let selectNodes = this.getSelectedComponents() as SchemaNodeModel[]\r\n    let clonenode = selectNodes[0].clone()\r\n    const copie = clonenode.serialize()\r\n\r\n\r\n    console.log(copie)\r\n\r\n    localStorage.setItem('clipboard', JSON.stringify(copie));\r\n  };\r\n\r\n  onPromise(id : string) {\r\n    return new Promise<BaseModel>((resolve, reject) => {\r\n      let rs = new SchemaNodeModel()\r\n      resolve(rs);\r\n    });\r\n  }\r\n\r\n\r\n  /** Paste */\r\n  handlePaste() {\r\n\r\n\r\n    let clipboardstr = localStorage.getItem('clipboard')\r\n\r\n    if(clipboardstr == null) clipboardstr = \"\"\r\n\r\n    const clipboard = JSON.parse(clipboardstr);\r\n    if (!clipboard) return;\r\n\r\n    console.log(clipboard)\r\n\r\n\r\n    let pastemodel = new SchemaNodeModel()\r\n \r\n    let deserializeData : any = {\r\n      data : clipboard,\r\n      engine : this.engine,\r\n      registerModel: () => {},\r\n    }\r\n\r\n    pastemodel.deserialize(deserializeData)\r\n    \r\n  \r\n    pastemodel.setPosition(100, 100);\r\n\r\n    console.log(pastemodel)\r\n    let model = this.engine.getModel() as DiagramModel\r\n    model.addAll(pastemodel)\r\n\r\n\r\n    //this.engine.fireEvent( nodes: models , 'componentsAdded');\r\n\r\n    this.engine.repaintCanvas();\r\n  };\r\n\r\n\r\n\r\n\r\n  \r\n}\r\n","import * as React from 'react';\r\nimport { DiagramEngine, PortWidget } from '@projectstorm/react-diagrams-core';\r\nimport { SchemaPortModel } from './SchemaPortModel';\r\nimport styled from '@emotion/styled';\r\n\r\nimport { MenuProvider  } from 'react-contexify';\r\n\r\n\r\nexport interface DefaultPortLabelProps {\r\n\tport: SchemaPortModel;\r\n\tengine: DiagramEngine;\r\n\r\n}\r\n\r\n\r\n\texport const PortLabel = styled.div`\r\n\t\tdisplay: flex;\r\n\t\tmargin-top: 1px;\r\n\t\talign-items: center;\r\n\t\t&:hover {\r\n\t\t\tbackground: rgb(192, 255, 0);\r\n\t\t}\r\n\t`;\r\n\r\n\texport const Label = styled.div`\r\n\t\tpadding: 0 5px;\r\n\t\tflex-grow: 1;\r\n\t`;\r\n\r\n\texport const Port = styled.div`\r\n\t\twidth: 16px;\r\n\t\theight: 21px;\r\n\t\tbackground: rgba(255, 255, 244, 0.1);\r\n\t\t&:hover {\r\n\t\t\tbackground: rgb(192, 255, 0);\r\n\t\t}\r\n\t`;\r\n\r\n\r\nexport class SchemaPortLabel extends React.Component<DefaultPortLabelProps> {\r\n\trender() {\r\n\t\tconst port = (\r\n\t\t\t<PortWidget engine={this.props.engine} port={this.props.port}>\r\n\t\t\t\t<Port />\r\n\t\t\t</PortWidget>\r\n\t\t);\r\n\t\tconst label = <Label>{this.props.port.getOptions().label}</Label>;\r\n\r\n\t\treturn (\r\n\t\t\t<MenuProvider id=\"nodeedit\" storeRef={false} >\r\n\t\t\t\t<PortLabel>\r\n\t\t\t\t{this.props.port.getOptions().in ? port : label}\r\n\t\t\t\t{this.props.port.getOptions().in ? label : port}\r\n\t\t\t\t</PortLabel>\r\n\t\t\t</MenuProvider>\r\n\t\t\t\r\n\t\t);\r\n\t}\r\n}","import * as React from 'react';\r\nimport * as _ from 'lodash';\r\nimport { DiagramEngine } from '@projectstorm/react-diagrams-core';\r\nimport { SchemaNodeModel } from './SchemaNodeModel';\r\nimport { SchemaPortLabel } from '../port/SchemaPortLabelWidget';\r\nimport styled from '@emotion/styled';\r\nimport { css } from '@emotion/core';\r\nimport { SchemaPortModel } from '../port/SchemaPortModel';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\n\r\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\r\n\r\n\texport const Node = styled.div<{ background ?: string; selected: boolean }>`\r\n\t\r\n\t\r\n\r\n\t\tborder-style: solid;\r\n\r\n\t\tborder-color : grey;\r\n\r\n\t\tborder-width: thin;\r\n\r\n\t\tcolor: white;\r\n\t\t\r\n\t\toverflow: visible;\r\n\t\tfont-size: 13px;\r\n\t\t\r\n\t`;\r\n\r\n\texport const Title = styled.div`\r\n\t\tbackground-color: #005AA0;\r\n\t\tdisplay: flex;\r\n\t\tfont-weight: 600;\r\n\t\twhite-space: nowrap;\r\n\t\tjustify-items: center;\r\n\t`;\r\n\r\n\texport const TitleName = styled.div`\r\n\t\tmargin-left : 10px;\r\n\t\tflex-grow: 1;\r\n\t\tpadding: 10px 5px;\r\n\t`;\r\n\r\n\texport const Ports = styled.div`\r\n\t\tdisplay: flex;\r\n\t\tcolor : #5E666E;\r\n\t\tfont-weight: 600;\r\n\t\tbackground-color: white;\r\n\t`;\r\n\r\n\texport const PortsContainer = styled.div`\r\n\t\tflex-grow: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\t&:first-of-type {\r\n\t\t\tmargin-right: 10px;\r\n\t\t}\r\n\t\t&:only-child {\r\n\t\t\tmargin-right: 0px;\r\n\t\t}\r\n\t`;\r\n\r\n\r\nexport interface DefaultNodeProps {\r\n\tnode: SchemaNodeModel;\r\n\tengine: DiagramEngine;\r\n}\r\n\r\n/**\r\n * Default node that models the DefaultNodeModel. It creates two columns\r\n * for both all the input ports on the left, and the output ports on the right.\r\n */\r\n\r\n\r\nexport class SchemaNodeWidget extends React.Component<DefaultNodeProps> {\r\n\r\n\r\n\t  fireAction (event : any) {\r\n\t\tthis.props.engine.getActionEventBus().fireAction({\r\n\t\t  event: {\r\n\t\t\t...event,\r\n\t\t\tkey: '',\r\n\t\t\tpreventDefault: () => {},\r\n          stopPropagation: () => {},\r\n\t\t  },\r\n\t\t});\r\n\t  }\r\n\r\n\t  fireDeleteEvent(engine : DiagramEngine){\r\n\t\tlet e = { type: 'keydown', ctrlKey: true, code: 'Delete' }\r\n\t\tthis.fireAction(e);\r\n\t  }\r\n\r\n\tfireDoubleClick(engine : DiagramEngine){\r\n\t\tconsole.log(\"double click\")\r\n\t\tif(engine != undefined){\r\n\t\r\n\t\t\tengine.fireEvent({ }, 'onDoubleClick');\r\n\t\t}else{\r\n\t\t\tconsole.log(\"unid\")\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\r\n\tgeneratePort = (port : SchemaPortModel) => {\r\n\t\r\n\t\treturn <SchemaPortLabel engine={this.props.engine} port={port} key={port.getID()}  />;\r\n\t};\r\n\r\n\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Node\r\n\t\t\t\tdata-default-node-name={this.props.node.getOptions().name}\r\n\t\t\t\tselected={this.props.node.isSelected()}\r\n\t\t\t\tbackground={this.props.node.getOptions().color} onDoubleClick={() => this.fireDoubleClick(this.props.engine)}>\r\n\t\t\t\t<Title>\r\n\t\t\t\t\t<TitleName>{this.props.node.getOptions().name}</TitleName>\r\n\t\t\t\t\t<IconButton  onClick={()=> this.fireDeleteEvent(this.props.engine)} color=\"inherit\" size=\"small\">\r\n          \t\t\t\t<DeleteOutlineIcon/>\r\n        \t\t\t</IconButton>\r\n\r\n\t\t\t\t</Title>\r\n\t\t\t\t<Ports>\r\n\t\t\t\t\t<PortsContainer>{_.map(this.props.node.getInPorts(), this.generatePort)}</PortsContainer>\r\n\t\t\t\t\t<PortsContainer>{_.map(this.props.node.getOutPorts(), this.generatePort)}</PortsContainer>\r\n\t\t\t\t</Ports>\r\n\t\t\t</Node>\r\n\t\t);\r\n\t}\r\n}","import * as React from 'react';\r\nimport { SchemaNodeModel } from './SchemaNodeModel';\r\nimport { SchemaNodeWidget } from './SchemaNodeWidget';\r\nimport { AbstractReactFactory , GenerateWidgetEvent } from '@projectstorm/react-canvas-core';\r\nimport { DiagramEngine } from '@projectstorm/react-diagrams-core';\r\nimport { MenuProvider  } from 'react-contexify';\r\n\r\nexport class SchemaNodeFactory extends AbstractReactFactory<SchemaNodeModel, DiagramEngine> {\r\n\r\n\tconstructor() {\r\n\t\tsuper('default');\r\n\t}\r\n\t\r\n\r\n\tgenerateReactWidget(event : any): JSX.Element {\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<MenuProvider id=\"component\" storeRef={false} data={event.model}>\r\n\t\t\t\t<SchemaNodeWidget engine={this.engine} node={event.model}  />\r\n\t\t\t</MenuProvider>\r\n\t\t\t)\r\n\t}\r\n\r\n\tgenerateModel(initialConfig : any) {\r\n\t\treturn new SchemaNodeModel('Node 2', 'rgb(192,255,0)');\r\n\t}\r\n}","import createEngine, { DefaultLinkModel, DefaultNodeModel , DiagramEngine,  DiagramModel , PathFindingLinkFactory } from \"@projectstorm/react-diagrams\";\r\n\r\n\r\nimport {SchemaNodeModel} from '../schemanode/node/SchemaNodeModel'\r\nimport {SchemaNodeFactory} from '../schemanode/node/SchemaNodeFactory'\r\n\r\n\r\nfunction GetEngine() : DiagramEngine  {\r\n \r\n    let rs = createEngine({registerDefaultDeleteItemsAction: false,\r\n})\r\n\r\n    rs.getNodeFactories().registerFactory(new SchemaNodeFactory());\r\n\r\n    const model = new DiagramModel();\r\n\r\n\r\n    /*\r\n    var node1 = new DefaultNodeModel({\r\n\t\tname: 'Node 1',\r\n\t\tcolor: 'rgb(0,192,255)'\r\n\t});\r\n\tnode1.setPosition(100, 100);\r\n\tlet port1 = node1.addOutPort('id');\r\n    node1.addInPort('int');\r\n\r\n\t//3-B) create another default node\r\n\tvar node2 = new DefaultNodeModel('Node 2', 'rgb(192,255,0)');\r\n\tlet port2 = node2.addInPort('product_id');\r\n    node2.addOutPort('int');\r\n\tnode2.setPosition(400, 100);\r\n\r\n\t// link the ports\r\n\tlet link1 = port1.link<DefaultLinkModel>(port2);\r\n\tlink1.getOptions().testName = 'Test';\r\n\tlink1.addLabel('Hello World!');\r\n    */\r\n    \r\n    rs.setModel(model);\r\n\r\n    return rs\r\n}\r\n\r\n\r\n\r\nconst engine = GetEngine()\r\nexport {engine , GetEngine}","\r\nimport * as _ from 'lodash';\r\n\r\n//import ClipboardAction from './actions/ClipboardAction';\r\nimport DeleteAction from './actions/DeleteAction';\r\nimport NewNodeAction from './actions/NewNodeAction';\r\nimport DuplicateAction from './actions/DuplicateAction';\r\n//import UndoRedoAction from './actions/UndoRedoAction';\r\nimport ZoomAction from './actions/ZoomAction';\r\nimport ClipboardAction from './actions/Clipboard'\r\nimport { Action } from '@projectstorm/react-canvas-core';\r\n\r\nimport { DiagramEngine, DiagramModel } from '@projectstorm/react-diagrams';\r\nimport { GetEngine } from '../libs/engine'\r\nimport { SchemaNodeModel } from '../schemanode/node/SchemaNodeModel';\r\nimport { TableData } from '../components/TableEditor';\r\nimport { Field } from '../schemanode/node/SchemaNodeModel'\r\n\r\nexport class DiagramController {\r\n\r\n  isLock: boolean;\r\n  engine: DiagramEngine\r\n\r\n  constructor() {\r\n    this.isLock = false\r\n    this.engine = GetEngine()\r\n\r\n    this.initActions()\r\n\r\n    console.log(this.getEngine().getModel().getZoomLevel())\r\n\r\n    let links = this.getEngine().getModel().getLinks()\r\n\r\n    let models = this.getEngine().getModel().getModels()\r\n\r\n    console.log(links)\r\n\r\n    //let p1= links[0].getTargetPort()\r\n    //let nodemd = p1.getNode() as SchemaNodeModel\r\n\r\n    //links[0].remove()\r\n\r\n    //this.getEngine().repaintCanvas()\r\n\r\n    //alert(nodemd.getOptions().name)\r\n    //console.log(p1)\r\n  }\r\n\r\n\r\n\r\n  initActions() {\r\n\r\n\r\n    let actions: Action[] = [\r\n      new DeleteAction(true),\r\n      new NewNodeAction(true),\r\n      new DuplicateAction(true),\r\n      new ClipboardAction(true)\r\n\r\n    ]\r\n\r\n    actions.forEach(Action =>\r\n      this.engine\r\n        .getActionEventBus()\r\n        .registerAction(Action),\r\n    );\r\n\r\n  }\r\n\r\n  fireAction(event: any) {\r\n    this.engine.getActionEventBus().fireAction({\r\n      event: {\r\n        ...event,\r\n        key: '',\r\n        preventDefault: () => { },\r\n        stopPropagation: () => { },\r\n      },\r\n    });\r\n  }\r\n\r\n\r\n  currentNode(): SchemaNodeModel | undefined {\r\n    let entities = this.engine\r\n      .getModel()\r\n      .getSelectedEntities()\r\n      .filter(model => !model.isLocked());\r\n\r\n    if (entities.length == 0) return undefined\r\n\r\n    let node = entities[0]\r\n\r\n    if (node instanceof SchemaNodeModel === false) return undefined\r\n\r\n    let rs = node as SchemaNodeModel\r\n\r\n    return rs\r\n  }\r\n\r\n  saveDataByString(data : string){\r\n    const model2 = new DiagramModel()\r\n    const model = JSON.parse(data)\r\n    let obj: ReturnType<DiagramModel['serialize']> = model\r\n    model2.deserializeModel(obj, this.getEngine())\r\n\t\t\tif (model2 == null) {\r\n\t\t\t\tconsole.log(\"model null\")\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.getEngine().setModel(model2)\r\n  }\r\n\r\n  linktest() {\r\n    this.linkNode()\r\n  }\r\n\r\n  linkNode() {\r\n    let nodes = this.getEngine().getModel().getNodes() as SchemaNodeModel[]\r\n    alert(nodes[1].getOptions().name)\r\n    let sourcePort = nodes[0].getOutPorts()[0]\r\n    let targetPort = nodes[1].getInPorts()[0]\r\n\r\n\r\n    let link = sourcePort.link(targetPort)\r\n\r\n    targetPort.reportPosition()\r\n    sourcePort.reportPosition()\r\n\r\n    this.getEngine().getModel().addAll(link);\r\n    this.getEngine().repaintCanvas()\r\n  }\r\n\r\n  updateNodeName(e: string) {\r\n    let node = this.currentNode()\r\n    if (node == undefined) return\r\n    node.getOptions().name = e\r\n    this.getEngine().repaintCanvas()\r\n  }\r\n\r\n  linkModel(targetNodeId: string,\r\n    targetNodeField: string, mainNodeField: string,) {\r\n    let node = this.currentNode()\r\n    if (node == undefined) return\r\n    let targetNode = this.engine.getModel().getNode(targetNodeId) as SchemaNodeModel\r\n    let link = node.linkForeignKey(targetNode, targetNodeField, mainNodeField)\r\n    if (link == undefined) return\r\n    this.engine.getModel().addAll(link)\r\n    this.engine.repaintCanvas()\r\n  }\r\n\r\n  setCurrentNode(node: SchemaNodeModel) {\r\n    this.engine.repaintCanvas()\r\n  }\r\n\r\n  updateNode(tb: TableData) {\r\n    let node = this.currentNode()\r\n\r\n    if (node == undefined) return\r\n\r\n    node.updateNode(tb)\r\n\r\n    this.getEngine().repaintCanvas()\r\n\r\n  }\r\n\r\n  testEdit() {\r\n\r\n    let node = this.currentNode()\r\n\r\n    let tb = {\r\n      tablename: \"top\",\r\n      fields: [{\r\n        fieldName: \"Id\",\r\n        fieldType: \"int\"\r\n      }, {\r\n        fieldName: \"ProductId\",\r\n        fieldType: \"varchar\"\r\n      }, {\r\n        fieldName: \"Id\",\r\n        fieldType: \"int\"\r\n      }\r\n      ]\r\n    }\r\n\r\n    if (node == undefined) return\r\n\r\n    node.updateNode(tb)\r\n\r\n    this.getEngine().repaintCanvas()\r\n\r\n  }\r\n\r\n  doZoom(value : number){\r\n    let model = this.getEngine().getModel()\r\n    let zoomLevel = model.getZoomLevel()\r\n    console.log(zoomLevel)\r\n    model.setZoomLevel(zoomLevel + value)\r\n    this.getEngine().repaintCanvas()\r\n  }\r\n\r\n  updateFieldOption(f: Field) {\r\n    let node = this.currentNode()\r\n    if (node == undefined) return\r\n    node.addOrUpdateFieldOption(f)\r\n  }\r\n\r\n\r\n  copySelected = () => {\r\n    this.fireAction({ type: 'keydown', ctrlKey: true, code: 'KeyC' });\r\n\r\n  }\r\n\r\n  newNode() {\r\n    this.fireAction({ type: 'keydown', ctrlKey: true, code: 'KeyB' });\r\n  }\r\n\r\n  duplicateSelected = () => {\r\n    this.fireAction({ type: 'keydown', ctrlKey: true, code: 'KeyD' });\r\n  }\r\n\r\n  cutSelected = () =>\r\n    this.fireAction({ type: 'keydown', ctrlKey: true, code: 'KeyX' });\r\n\r\n\r\n  pasteSelected = () =>\r\n    this.fireAction({ type: 'keydown', ctrlKey: true, code: 'KeyV' });\r\n\r\n  deleteSelected = () =>\r\n    this.fireAction({ type: 'keydown', ctrlKey: true, code: 'Delete' });\r\n\r\n  undo = () =>\r\n    this.fireAction({ type: 'keydown', ctrlKey: true, code: 'KeyZ' });\r\n\r\n  zoomIn(event: any) {\r\n    this.fireAction({\r\n      clientX: event.clientX,\r\n      clientY: event.clientY,\r\n      type: 'wheel',\r\n      deltaY: +1,\r\n    });\r\n  }\r\n\r\n  zoomOut(event: any) {\r\n    this.fireAction({\r\n      clientX: event.clientX,\r\n      clientY: event.clientY,\r\n      type: 'wheel',\r\n      deltaY: -1,\r\n    });\r\n  }\r\n\r\n\r\n\r\n  getEngine(): DiagramEngine {\r\n    return this.engine\r\n  }\r\n\r\n\r\n\r\n}","import React , {FunctionComponent, useState} from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Button from '@material-ui/core/Button';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      flexGrow: 0,\r\n    },\r\n    inputEdit : {\r\n      backgroundColor : \"#3F51B5\",\r\n      padding : 8,\r\n      color : \"white\",\r\n      border: \"none\",\r\n      borderRadius: 4,\r\n      fontSize : 20\r\n\r\n \r\n    },\r\n    menuButton: {\r\n      marginRight: theme.spacing(2),\r\n    },\r\n    title: {\r\n      flexGrow: 1,\r\n    },\r\n  }),\r\n);\r\n\r\ninterface AppbarProp {\r\n  title : string,\r\n  onDelete : () => void,\r\n  onEndEdit : (e : string) => void\r\n}\r\n\r\nexport const  Appbar : FunctionComponent<AppbarProp> = ({ onDelete , title , onEndEdit }) => {\r\n  const classes = useStyles();\r\n\r\n  const [isEdit, setisEdit] = useState(false)\r\n\r\n  const [textInput, settextInput] = useState(\"\")\r\n\r\n  function handleChange(e : any){\r\n    settextInput(e.target.value)\r\n  }\r\n\r\n  function handleBlur(){\r\n    setisEdit(!isEdit)\r\n    \r\n    onEndEdit(textInput)\r\n  }\r\n\r\n\r\n\r\n  function handleOpenEdit(){\r\n    setisEdit(true)\r\n    settextInput(title)\r\n  }\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <AppBar position=\"static\" elevation={0}>\r\n        <Toolbar>\r\n          <IconButton edge=\"start\" className={classes.menuButton} color=\"inherit\" aria-label=\"menu\">\r\n            <MenuIcon />\r\n          </IconButton>\r\n          {(isEdit) ? \r\n           <input value={textInput} onChange={handleChange} onBlur={ handleBlur} className={classes.inputEdit} />\r\n         \r\n          :\r\n          <Typography  variant=\"h6\" className={classes.title} onClick={handleOpenEdit}>\r\n            {title}\r\n          </Typography>\r\n          }\r\n          <IconButton color=\"inherit\" onClick={onDelete}><DeleteOutlineIcon/></IconButton>\r\n        </Toolbar>\r\n      </AppBar>\r\n    </div>\r\n  );\r\n}","import React, { FunctionComponent, useEffect, useMemo, useState } from 'react'\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\r\nimport { Appbar } from './Appbar'\r\nimport TableMat from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport { BaseModel } from '@projectstorm/react-canvas-core'\r\n\r\n\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport AddCircleOutlineIcon from '@material-ui/icons/AddCircleOutline';\r\nimport { DiagramEngine, NodeModel } from '@projectstorm/react-diagrams';\r\nimport { SchemaNodeModel, Field } from '../schemanode/node/SchemaNodeModel';\r\nimport { DiagramController } from '../DiagramController/DiagramCtr';\r\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\r\n\r\nexport interface TableProps {\r\n  isOpen: boolean,\r\n  diagramctr: DiagramController,\r\n  forceUpdate: boolean,\r\n  onclose: () => void\r\n}\r\n\r\nexport interface TableData {\r\n  id?: string,\r\n  tablename: string,\r\n  fields: Field[]\r\n}\r\n\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    styledTable: {\r\n      \"borderCollapse\": \"collapse\",\r\n      \"margin\": \"25px 0\", \"fontSize\": \"0.9em\", \"fontFamily\": \"sans-serif\",\r\n      \"minWidth\": \"400px\", \"boxShadow\": \"0 0 20px rgba(0, 0, 0, 0.15)\"\r\n    },\r\n    cell: {\r\n      padding: 10\r\n    }\r\n\r\n  }),\r\n);\r\n\r\n\r\nexport const TableEditor: FunctionComponent<TableProps> = ({ isOpen, diagramctr, onclose, forceUpdate }) => {\r\n\r\n\r\n  const classes = useStyles();\r\n\r\n  const [currentTable, setTable] = useState(getNodeData(diagramctr))\r\n\r\n  const [otherTable, setotherTable] = useState(getOtherTable())\r\n\r\n  const [textInput, settextInput] = useState(\"\")\r\n\r\n\r\n  const [isEdit, setisEdit] = useState(false)\r\n\r\n  const [currentSelectTableId, setcurrentSelectTableId] = useState(\"\")\r\n\r\n  const [currentFieldId, setcurrentFieldId] = useState(\"\")\r\n\r\n  const currentField = useMemo(() => loadTableFieldSelect(), [currentSelectTableId]);\r\n\r\n  const [toggleUpdate, settoggleUpdate] = useState(false)\r\n\r\n  const [currentEdit, setcurrentEdit] = useState(\"\")\r\n\r\n  const [typeSelect, settypeSelect] = useState(\"\")\r\n\r\n  useEffect(() => {\r\n    setTable(getNodeData(diagramctr))\r\n    console.log('update tb')\r\n  }, [isOpen, toggleUpdate, forceUpdate])\r\n\r\n  function getOtherTable(): TableData[] {\r\n\r\n\r\n    let rs: TableData[] = []\r\n    let alltb = diagramctr.getEngine().getModel().getNodes() as SchemaNodeModel[]\r\n    alltb.forEach(tb => {\r\n      let name = tb.getOptions().name\r\n      if (name == undefined) name = \"\"\r\n      let add: TableData = {\r\n        id: tb.getID(),\r\n        tablename: name,\r\n        fields: tb.getAllField()\r\n      }\r\n      rs.push(add)\r\n    });\r\n    return rs\r\n  }\r\n\r\n\r\n  function getNodeData(diagramctr: DiagramController): TableData {\r\n    let rs: TableData = {\r\n      id: \"\",\r\n      tablename: '',\r\n      fields: []\r\n    }\r\n    let node = diagramctr.currentNode()\r\n\r\n    if (node == undefined) return rs\r\n\r\n    if (node instanceof SchemaNodeModel) {\r\n      console.log(\"Start getNodeData function\")\r\n      let nodedata = node as SchemaNodeModel\r\n      let tbname = nodedata.getOptions().name\r\n      if (tbname === undefined) tbname = \"\"\r\n      rs.tablename = tbname\r\n      rs.id = nodedata.getID()\r\n      rs.fields = getFieldsData(nodedata)\r\n    }\r\n\r\n    return rs\r\n  }\r\n\r\n  function getFieldsData(node: SchemaNodeModel): Field[] {\r\n    let fieldlist = node.getAllField()\r\n    console.log(\"get all fields\")\r\n    console.log(fieldlist)\r\n    return fieldlist\r\n  }\r\n\r\n  function setEditField(id: string | undefined, fieldName: string) {\r\n    if(id === undefined) id = \"\"\r\n    setisEdit(true)\r\n    settextInput(fieldName)\r\n    setcurrentEdit(id)\r\n  }\r\n\r\n  function closeEdit() {\r\n    setisEdit(true)\r\n    updateNode()\r\n    setcurrentEdit(\"\")\r\n  }\r\n\r\n  function updateNode() {\r\n    let newtb = currentTable\r\n\r\n    //let indexof = newtb.fields.findIndex(f => f.fieldName == currentEdit)\r\n\r\n    let indexof = newtb.fields.findIndex(f => f.inId == currentEdit)\r\n\r\n    if (indexof == -1) return\r\n\r\n    newtb.fields[indexof].fieldName = textInput\r\n\r\n    if (typeSelect != \"\") newtb.fields[indexof].fieldType = typeSelect\r\n    setTable(newtb)\r\n\r\n    diagramctr.updateNode(newtb)\r\n  }\r\n\r\n  function handleChange(e: any) {\r\n    settextInput(e.target.value)\r\n  }\r\n\r\n  function handleTypeChange(e: any) {\r\n    settypeSelect(e.target.value)\r\n  }\r\n\r\n  function onDelete() {\r\n    let node = diagramctr.currentNode()\r\n    if (node == undefined) return\r\n    diagramctr.deleteSelected()\r\n    onclose()\r\n  }\r\n\r\n  function newField() {\r\n    let node = diagramctr.currentNode()\r\n    if (node == undefined) return\r\n    node.AddNewField()\r\n\r\n    let newtb = currentTable\r\n    newtb.fields.push({\r\n      fieldName: \"test\",\r\n      fieldType: \"int\"\r\n    })\r\n    setTable(newtb)\r\n\r\n    settoggleUpdate(!toggleUpdate)\r\n\r\n    diagramctr.getEngine().repaintCanvas()\r\n  }\r\n\r\n  function removeField(id: string | undefined) {\r\n    if (id == undefined) return\r\n    let node = diagramctr.currentNode()\r\n    if (node == undefined) return\r\n    node.removeFieldbyId(id)\r\n    settoggleUpdate(!toggleUpdate)\r\n    diagramctr.getEngine().repaintCanvas()\r\n  }\r\n\r\n  function onSelectTableChange(e: any) {\r\n    setcurrentSelectTableId(e.target.value)\r\n  }\r\n\r\n  function loadTableFieldSelect(): Field[] {\r\n    if (currentSelectTableId == \"\") return []\r\n    let tb = otherTable.find(t => t.id === currentSelectTableId)\r\n    if (tb == undefined) return []\r\n    return tb.fields\r\n  }\r\n\r\n  function onChangeFieldSelect(e: any) {\r\n    let targetPortOutId = e.target.value\r\n    let sourceField = currentTable.fields.find(f => f.inId == currentEdit)\r\n\r\n    setcurrentFieldId(targetPortOutId)\r\n\r\n    let currentTableId = (currentTable.id == undefined) ? \"\" : currentTable.id == undefined\r\n    if (currentTableId == currentSelectTableId || sourceField == undefined) return // if link self table and selt field\r\n    alert('on link')\r\n\r\n    let sourceFieldId = (sourceField.inId == undefined) ? \"\" : sourceField.inId\r\n    diagramctr.linkModel(currentSelectTableId, targetPortOutId, sourceFieldId)\r\n\r\n  }\r\n\r\n\r\n  function onNameChange(e: string) {\r\n    let newtb = currentTable\r\n    newtb.tablename = e\r\n    setTable(newtb)\r\n\r\n    diagramctr.updateNodeName(e)\r\n\r\n    settoggleUpdate(!toggleUpdate)\r\n\r\n  }\r\n\r\n  function getFieldOption(f: Field, optionName: string): any {\r\n    let fieldOption = f.fieldOption\r\n    if (fieldOption == undefined) {\r\n      console.log('field option undifine')\r\n      return false\r\n    }\r\n    if (optionName == \"pk\") return fieldOption.pk\r\n    if (optionName == \"fk\") return fieldOption.fk\r\n\r\n  }\r\n\r\n  function setFieldOption(e: any, idField: string | undefined, optionName: string) {\r\n\r\n    if (idField == undefined) return\r\n\r\n    console.log(optionName)\r\n\r\n    let fieldIndexof = currentTable.fields.findIndex(f => f.inId == idField)\r\n    let tb = currentTable\r\n    let newfieldOption = tb.fields[fieldIndexof].fieldOption\r\n    if (newfieldOption == undefined) return\r\n\r\n    if (optionName == \"pk\") {\r\n      newfieldOption.pk = !newfieldOption.pk\r\n    }\r\n    if (optionName == \"fk\") {\r\n      newfieldOption.fk = !newfieldOption.fk\r\n    }\r\n\r\n    tb.fields[fieldIndexof].fieldOption = newfieldOption\r\n    setTable(tb)\r\n\r\n    console.log(newfieldOption)\r\n    diagramctr.updateFieldOption(tb.fields[fieldIndexof])\r\n    settoggleUpdate(!toggleUpdate)\r\n  }\r\n\r\n  return <Drawer anchor={\"right\"} open={isOpen} style={{ width: 600 }} onClose={onclose}>\r\n    <div>\r\n      <Appbar onDelete={onDelete} title={currentTable.tablename} onEndEdit={onNameChange}></Appbar>\r\n      <TableContainer>\r\n        <TableMat aria-label=\"simple table\">\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell className={classes.cell}>Field Name</TableCell>\r\n              <TableCell className={classes.cell}>Type Name</TableCell>\r\n              <TableCell className={classes.cell}>PK</TableCell>\r\n              <TableCell className={classes.cell}>FK</TableCell>\r\n              <TableCell className={classes.cell}>Action</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {currentTable.fields.map((row: Field, index: number) => (\r\n              <TableRow key={row.fieldName} className={classes.cell}>\r\n                {(isEdit && currentEdit == row.inId) ?\r\n                  <>\r\n                    <TableCell component=\"th\" scope=\"row\" className={classes.cell}>\r\n                      <input onBlur={() => closeEdit()}\r\n                        onChange={handleChange} value={textInput} />\r\n                    </TableCell>\r\n                    <TableCell component=\"th\" scope=\"row\" className={classes.cell}>\r\n                      <select onChange={handleTypeChange} value={typeSelect} >\r\n                        <option value=\"int\">Interger</option>\r\n                        <option value=\"varchar\">Varchar</option>\r\n                        <option value=\"float\">Float</option>\r\n                        <option value=\"bool\">Boolean</option>\r\n                      </select>\r\n                    </TableCell>\r\n                    <TableCell component=\"th\" scope=\"row\" className={classes.cell}>\r\n\r\n                      <select placeholder=\"Select Table\" value={currentSelectTableId} onChange={onSelectTableChange}>\r\n                        {otherTable.map(o => <option key={o.id} value={o.id}>{o.tablename}</option>)}\r\n                      </select>\r\n\r\n                      <select placeholder=\"Select Field\" value={currentFieldId} onChange={onChangeFieldSelect}>\r\n                        {currentField.map(f => <option key={f.fieldName} value={f.outId}>{f.fieldName}</option>)}\r\n                      </select>\r\n                    </TableCell>\r\n                  </>\r\n                  :\r\n                  <>\r\n                    <TableCell className={classes.cell} component=\"th\" scope=\"row\" onClick={() => setEditField(row.inId, row.fieldName)}>\r\n                      {row.fieldName}\r\n                    </TableCell>\r\n\r\n                    <TableCell className={classes.cell} component=\"th\" scope=\"row\" onClick={() => setEditField(row.inId, row.fieldName)}>\r\n                      {row.fieldType}\r\n                    </TableCell>\r\n                  </>\r\n                }\r\n\r\n                <TableCell className={classes.cell}>\r\n                  <input type=\"checkbox\" checked={(getFieldOption(row, \"pk\"))}\r\n                    onChange={(e) => setFieldOption(e, row.inId, \"pk\")} key={`pk${row.inId}`} />\r\n                </TableCell>\r\n                <TableCell>\r\n                  <input type=\"checkbox\" checked={(getFieldOption(row, \"fk\"))}\r\n                    onChange={(e) => setFieldOption(e, row.inId, \"fk\")} />\r\n                </TableCell>\r\n                <TableCell className={classes.cell} >\r\n                  <IconButton onClick={() => removeField(row.inId)} size=\"small\">\r\n                    <DeleteOutlineIcon></DeleteOutlineIcon>\r\n                  </IconButton>\r\n                </TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </TableMat>\r\n      </TableContainer>\r\n      <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\" onClick={() => newField()}>\r\n        <AddCircleOutlineIcon />\r\n      </IconButton>\r\n    </div>\r\n  </Drawer>\r\n}","import React , {FunctionComponent} from 'react';\r\n\r\nimport { Menu, Item, Separator } from 'react-contexify';\r\n\r\nimport { Redo, Undo, Paste, ZoomIn, ZoomOut } from '../Icons';\r\nimport Key from './KeyMenu';\r\nimport ContextMenuIconContainer from './ContextMenuIconContainer';\r\nimport ContextMenuShortcutContainer from './ContextMenuShortcutContainer';\r\n\r\nimport {ContextFunction} from './FunctionList'\r\n\r\n\r\nexport const SimpleContext : FunctionComponent = () => (\r\n  <Menu id=\"nodeedit\">\r\n  <Item>\r\n    <ContextMenuIconContainer>\r\n      <Paste />\r\n    </ContextMenuIconContainer>\r\n    Paste\r\n    <ContextMenuShortcutContainer>\r\n      <Key>CTRL</Key>\r\n      <Key>V</Key>\r\n    </ContextMenuShortcutContainer>\r\n  </Item>\r\n\r\n  <Separator />\r\n\r\n  <Item>\r\n    <ContextMenuIconContainer>\r\n      <ZoomIn />\r\n    </ContextMenuIconContainer>\r\n    Zoom in\r\n  </Item>\r\n  <Item>\r\n    <ContextMenuIconContainer>\r\n      <ZoomOut />\r\n    </ContextMenuIconContainer>\r\n    Zoom out\r\n  </Item>\r\n\r\n  <Separator />\r\n\r\n  <Item>\r\n    <ContextMenuIconContainer>\r\n      <Undo />\r\n    </ContextMenuIconContainer>\r\n    Undo\r\n    <ContextMenuShortcutContainer>\r\n      <Key>CTRL</Key>\r\n      <Key>Z</Key>\r\n    </ContextMenuShortcutContainer>\r\n  </Item>\r\n\r\n  <Item>\r\n    <ContextMenuIconContainer>\r\n      <Redo />\r\n    </ContextMenuIconContainer>\r\n    Redo\r\n    <ContextMenuShortcutContainer>\r\n      <Key>CTRL</Key>\r\n      <Key>SHIFT</Key>\r\n      <Key>Z</Key>\r\n    </ContextMenuShortcutContainer>\r\n  </Item>\r\n</Menu>\r\n);\r\n\r\nexport default SimpleContext;","import BaseGenerate from \"./BaseGenerate\"\r\n\r\nclass MySqlGenerate extends BaseGenerate {\r\n\r\n    getFields(field : any , isLastLine : boolean = false) : string{\r\n        let newLineAndTab = \", \\n \\t\"\r\n        let rs = `${field.fieldName} ${field.fieldType}` \r\n        if(isLastLine == false) rs += newLineAndTab\r\n        return rs \r\n    }\r\n  \r\n    getCreateTable(tb : any) : string{\r\n        let fields = ``\r\n        tb.fields.forEach((f: any , i : number)=>{\r\n            let isLastLine = false\r\n            if(tb.fields.length-1 == i) isLastLine = true\r\n            fields += this.getFields(f , isLastLine)\r\n        })\r\n\r\n        return `CREATE TABLE ${tb.tablename} (\\n \\t${fields} \\n ) `\r\n    }\r\n\r\n    export(data : any[]) : any {\r\n\r\n        let rs = ``\r\n       data.forEach(d=>{\r\n          rs += this.getCreateTable(d)\r\n          rs += \"\\n \\n\"\r\n       })\r\n       return rs\r\n    }\r\n}\r\n\r\nexport default MySqlGenerate\r\n  ","class BaseGenerate {\r\n\r\n    getFields(field : any) : string{\r\n        return `` \r\n    }\r\n  \r\n    getCreateTable(tb : any) : string{\r\n        return ``\r\n    }\r\n\r\n    export(data : any[]) : any {\r\n    \r\n      return ''\r\n    }\r\n}\r\n\r\nexport default BaseGenerate\r\n  ","\r\n\r\nexport enum ShareActionType {\r\n    TOGGLE_LOADING = \"TOGGLE_LOADING\",\r\n}\r\n\r\ninterface ToggleAction {\r\n    type: typeof ShareActionType.TOGGLE_LOADING\r\n    payload: boolean\r\n}\r\n\r\n  \r\n\r\n  \r\nexport type ShareActionTypes = ToggleAction ","import React, { FunctionComponent, useEffect , useState } from 'react'\r\n\r\nimport { CanvasWidget } from '@projectstorm/react-canvas-core';\r\n\r\nimport { DemoCanvasWidget } from '../components/CanvasDiagram';\r\n\r\n\r\nimport { Toolbar } from '../components/Toolbar'\r\nimport { AppToolbar } from '../components/AppToolbar'\r\nimport {  DiagramModel } from \"@projectstorm/react-diagrams\";\r\n\r\nimport { ExportEditor } from '../components/ExportEditor'\r\n\r\nimport { ContextMenus } from '../components/ContextMenus/ContextMenus'\r\nimport { MenuProvider } from 'react-contexify';\r\n\r\nimport { DiagramController } from '../DiagramController/DiagramCtr'\r\nimport { TableEditor } from '../components/TableEditor'\r\n\r\nimport SimpleContext from '../components/ContextMenus/SimpleContext'\r\nimport * as htmlToImage from 'html-to-image';\r\nimport BaseGenerate from '../api/export/BaseGenerate';\r\nimport MySqlGenerate from '../api/export/MySqlGenerate';\r\n\r\nimport {getAllTable} from '../libs/tableUtil'\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nimport Cookies from 'js-cookie'\r\n\r\nimport axios from 'axios'\r\n\r\nimport {Project , defaultProjects , jsonToProject, projectToJson} from '../interface/project'\r\nimport { useParams } from 'react-router';\r\nimport { RootState } from '../store';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { ToggleLoading } from '../reducer/share/action';\r\n\r\n\r\nenum VisibleStatus {\r\n\tPublic,\r\n\tPrivate,\r\n\tProtected\r\n}\r\n\r\n\r\ninterface EditorParamType {\r\n    projectId: string\r\n  }\r\n\r\nexport const Editor: FunctionComponent = () => {\r\n\r\n    let { projectId } = useParams<EditorParamType>();\r\n\r\n\tconst user = useSelector((state : RootState) => state.AuthReducer.user)\r\n\r\n\tconst dispatch = useDispatch()\r\n\r\n\tconst [update, setupdate] = useState(false)\r\n\r\n\tconst [isLogin, setisLogin] = useState(true)\r\n\r\n\tconst [diagram, setDiagram] = useState(new DiagramController())\r\n\r\n\tconst [toggleFileMenu, settoggleFileMenu] = useState(true)\r\n\r\n\tconst [isApiLoading, setisApiLoading] = useState(false)\r\n\r\n\r\n\tconst [currentProject, setcurrentProject] = useState(initProject())\r\n\r\n\tconst [isExportOpen, setisExportOpen] = useState(false)\r\n\r\n\tconst [saveData, setsaveData] = useState(\"\")\r\n\r\n\tconst [isEdit, setEdit] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n \r\n\t\tdiagram.getEngine().registerListener({\r\n\t\t\tonDoubleClick: () => ToggleEditor()\r\n\t\t})\r\n\t\tisLogger()\r\n\r\n\t\t\r\n\t}, [])\r\n\r\n\r\n\r\n\r\n\tfunction isLogger(){\r\n\t\r\n\t\tlet token = Cookies.get(\"ertoken\")\r\n\t\tif(token === undefined || token === \"\") {\r\n\t\t\tsetisLogin(false)\r\n\t\t\tsettoggleFileMenu(true)\r\n\t\t}else{\r\n\t\t\taxios.defaults.headers.common['Authorization'] = \"Bearer \" + token\r\n\t\t\tloaduserAndProject()\r\n\t\t}\r\n\t}\r\n\r\n\tconst loaduserAndProject = () => {\r\n\r\n\t\tlet baseUrl = \"https://toperbackend.herokuapp.com/\"\r\n\t\tlet loadProjectDataApi = \"project/loadproject/\" + projectId\r\n\t\tlet userApi = \"user/getuser\"\r\n\t\tlet projectApi = \"project/getprojects\"\r\n\r\n\t\taxios.get(baseUrl + loadProjectDataApi).then(rs=>{\r\n\r\n\r\n\t\t\tdiagram.saveDataByString(rs.data.projectDetail)\r\n\r\n\t\t})\r\n\t\t\r\n\t}\r\n\r\n\tconst saveProject = () => {\r\n\t\tconst newproject = currentProject\r\n\t\t\r\n\t\tlet baseUrl = \"https://toperbackend.herokuapp.com/\"\r\n\t\tlet api = \"project/update/\" + projectId\r\n\t\tconst model = diagram.getEngine().getModel().serialize()\r\n\t\tconst modelstr = JSON.stringify(model)\r\n\r\n\t\tnewproject.ProjectDetail = modelstr\r\n\r\n\t\tlet data = projectToJson(newproject)\r\n\r\n\t\tdispatch(ToggleLoading(true))\r\n\r\n\t\taxios.put(baseUrl + api , data).then(rs=>{\r\n\t\t\tconsole.log(rs)\r\n\t\r\n\t\t\tdispatch(ToggleLoading(false))\r\n\t\t})\r\n\t}\r\n\t\r\n\r\n\tfunction exportPng(filename : string) {\r\n\t\tlet node = document.getElementById('diagramcv');\r\n\t\tif (node == null) return\r\n\t\thtmlToImage.toPng(node)\r\n\t\t\t.then(function (dataUrl) {\r\n\t\t\t\tvar img = new Image();\r\n\t\t\t\timg.src = dataUrl;\r\n\t\t\t\tvar a = document.createElement('a');\r\n\t\t\t\t// toDataURL defaults to png, so we need to request a jpeg, then convert for file download.\r\n\t\t\t\ta.href = dataUrl\r\n\t\t\t\ta.download = filename;\r\n\t\t\t\ta.click();\r\n\t\t\t})\r\n\t\t\t.catch(function (error) {\r\n\t\t\t\tconsole.error('oops, something went wrong!', error);\r\n\t\t\t});\r\n\t}\r\n\r\n\tfunction initProject() : Project{\r\n\t\tlet pid = uuidv4()\r\n\t\tlet project : Project = {\r\n\t\t\tProjectName : \"Projecttyu\",\r\n\t\t\tProjectDescription : \"hello world\",\r\n\t\t\tProjectDetail : \"\",\r\n\t\t\tVisibleStatus : VisibleStatus.Private,\r\n\t\t\tUserId : user.Id,\r\n\t\t\tShareUrl : \"xff\"\r\n\t\t\t\r\n\t\t}\r\n\t\treturn project\r\n\t}\r\n\r\n\tfunction openExport() { setisExportOpen(true) }\r\n\r\n\tfunction ToggleEditor() {\r\n\t\tsetEdit(!isEdit)\r\n\t}\r\n\r\n\tfunction onZoomFit() {\r\n\t\talert('zoom fit ')\r\n\t\tdiagram.getEngine().zoomToFit()\r\n\t}\r\n\r\n\tfunction newTable() {\r\n\t\tdiagram.newNode()\r\n\t}\r\n\r\n\tfunction saveSerial() {\r\n\t\tlet modelJson = diagram.getEngine().getModel().serialize()\r\n\r\n\t\tlet modelStr = JSON.stringify(modelJson)\r\n\r\n\t\t//new code\r\n\t\tlet rs : Project = {\r\n\t\t\tId : \"\",\r\n\t\t\tProjectName : currentProject.ProjectName,\r\n\t\t\tProjectDescription : currentProject.ProjectDescription,\r\n\t\t\tVisibleStatus : currentProject.VisibleStatus,\r\n\t\t\tShareUrl : \"\",\r\n\t\t\tUserId : currentProject.UserId,\r\n\t\t\tProjectDetail : modelStr\r\n\t\t}\r\n\r\n\t\tdownloadFile(rs.ProjectName + \".er\" , JSON.stringify(rs))\r\n\r\n\t\t//\r\n\r\n\r\n\t\tsetsaveData(modelStr)\r\n\r\n\t\tconsole.log(modelJson)\r\n\r\n\t\tdownloadFile(\"someer.er\" , modelStr)\r\n\t\t\r\n\t}\r\n\r\n\r\n\tfunction loadOpenFile() {\r\n\t\tvar elem = document.getElementById(\"fileinput\");\r\n\t\tif (elem && document.createEvent) {\r\n\t\t\tvar evt = document.createEvent(\"MouseEvents\");\r\n\t\t\tevt.initEvent(\"click\", true, false);\r\n\t\t\telem.dispatchEvent(evt);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onLoadFile(e: any) {\r\n\t\talert(\"select\")\r\n\t\tvar input = e.target;\r\n\t\tconsole.log(e)\r\n\t\tvar reader = new FileReader();\r\n\t\treader.onload = (es) => {\r\n\t\t\tvar text: any = reader.result;\r\n\r\n\t\t\tconsole.log(text)\r\n\t\t\tlet model2 = new DiagramModel()\r\n\t\t\tlet obj: ReturnType<DiagramModel['serialize']> = JSON.parse(text);\r\n\t\t\tmodel2.deserializeModel(obj, diagram.engine)\r\n\t\t\tif (model2 == null) {\r\n\t\t\t\tconsole.log(\"model null\")\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\te.target.value = null\r\n\t\t\tdiagram.getEngine().setModel(model2)\r\n\r\n\t\t};\r\n\t\treader.readAsText(input.files[0]);\r\n\t}\r\n\r\n\tfunction loadSerial() {\r\n\r\n\t\tif (saveData == \"\") return\r\n\t\tlet str = saveData\r\n\t\tlet model2 = new DiagramModel()\r\n\t\tlet obj: ReturnType<DiagramModel['serialize']> = JSON.parse(str);\r\n\t\tmodel2.deserializeModel(obj, diagram.engine)\r\n\t\tif (model2 == null) {\r\n\t\t\tconsole.log(\"model null\")\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tdiagram.getEngine().setModel(model2)\r\n\t\ttogglePropUpdate()\r\n\t\tconsole.log(\"load sucess\")\r\n\t}\r\n\r\n\tfunction togglePropUpdate() {\r\n\t\tsetupdate(!update)\r\n\t}\r\n\r\n\tfunction downloadFile(fileName : string , content : string){\r\n\t\tvar a = document.createElement('a');\r\n\t\t// toDataURL defaults to png, so we need to request a jpeg, then convert for file download.\r\n\t\ta.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));\r\n\t\ta.setAttribute('download', fileName);\r\n\r\n\t\ta.style.display = 'none';\r\n\t\tdocument.body.appendChild(a);\r\n\r\n\t\ta.click();\r\n\r\n\t\tdocument.body.removeChild(a);\r\n\t}\r\n\r\n\tfunction exportSelect(filename : string,codeGen : BaseGenerate){\r\n\t\tlet tbs = getAllTable(diagram)\r\n\t\t//alert(JSON.stringify(tbs))\r\n\t\tlet str = codeGen.export(tbs)\r\n\t\talert(str)\r\n\r\n\t\tdownloadFile(filename , str)\r\n\t}\r\n\r\n\tfunction exportSql(filename : string){exportSelect(filename , new MySqlGenerate())}\r\n\r\n\tfunction zoomIn() {diagram.doZoom(20)}\r\n\r\n\tfunction zoomOut() {diagram.doZoom(-20)}\r\n\r\n\tfunction testEx(e : string){alert(e)}\r\n\r\n\treturn (\r\n\t\t<React.Fragment>\r\n\r\n\t\t\t<AppToolbar onExport={openExport}/>\r\n\t\t\t<Toolbar onZoomIn={zoomIn}\r\n\t\t\tonZoomOut={zoomOut} onZoomFit={loadOpenFile} newTable={newTable} onSave={saveProject} \r\n\t\t\tonLoad={loadOpenFile} />\r\n\t\r\n\t\t\t<ExportEditor \r\n\t\t\t\tisOpen={isExportOpen} onclose={() => setisExportOpen(false)} exportTest={testEx}\r\n\t\t\t\texportPng={exportPng} exportPdf={exportPng} exportSql={exportSql} fileName={currentProject.ProjectName}\r\n\t\t\t/>\r\n\t\t\t<input type=\"file\" id=\"fileinput\" style={{ display: \"none\" }} onChange={onLoadFile}/>\r\n\r\n\t\t\t<TableEditor isOpen={isEdit} diagramctr={diagram} \r\n\t\t\tonclose={ToggleEditor} forceUpdate={update} />\r\n\r\n\t\t\t<MenuProvider id=\"diagram\" storeRef={false} >\r\n\t\t\t\t<DemoCanvasWidget background=\"#E9E9E9\" color=\"#808080\" >\r\n\t\t\t\t\t<CanvasWidget engine={diagram.engine} className=\"canvas\" />\r\n\t\t\t\t</DemoCanvasWidget>\r\n\t\t\t</MenuProvider>\r\n\r\n\t\t\t<SimpleContext  />\r\n\r\n\t\t\t<ContextMenus copyFunc={diagram.copySelected} pasteFunc={diagram.pasteSelected} deleteFunc={diagram.deleteSelected}\r\n\t\t\tduplicateFunc={diagram.duplicateSelected} cutFunc={diagram.cutSelected} \r\n\t\t\tzoomIn={zoomIn} zoomOut={zoomOut}/>\r\n\r\n\t\t</React.Fragment>\r\n\r\n\t);\r\n\r\n}\r\n\r\n\r\n\r\n","export interface Project{\r\n    Id ?: string;\r\n    ProjectName : string;\r\n    ProjectDescription : string;\r\n    UserId : string;\r\n    VisibleStatus : number;\r\n    ShareUrl : string;\r\n    ProjectDetail : string;\r\n}\r\n\r\nexport function defaultProject() : Project{\r\n    let rs : Project = {\r\n        Id : \"\",\r\n        ProjectName : \"\" ,\r\n        ProjectDescription : \"\",\r\n        UserId : \"\",\r\n        VisibleStatus : 1,\r\n        ShareUrl  : \"\",\r\n        ProjectDetail : \"\"\r\n    }\r\n    return rs\r\n}\r\n\r\nexport function defaultProjects() : Project[]{\r\n    return []\r\n}\r\n\r\nexport function jsonToProject(d : any) : Project{\r\n    let rs : Project = {\r\n            Id : d._id,\r\n\t\t    ProjectName : d.projectName,\r\n\t\t\tProjectDescription : d.projectDescription,\r\n\t\t\tProjectDetail : \"\",\r\n\t\t\tVisibleStatus :  d.visibleStatus,\r\n\t\t\tUserId :  d.user,\r\n\t\t\tShareUrl : \"\"\r\n    }\r\n    return rs\r\n}\r\n\r\nexport function projectToJson(p : Project) {\r\n    let rs : any = {\r\n        projectName : p.ProjectName,\r\n        projectDescription : p.ProjectDescription,\r\n        projectDetail : p.ProjectDetail,\r\n        user : p.UserId,\r\n        visibleStatus : p.VisibleStatus,\r\n        shareUrl : p.ShareUrl\r\n    }\r\n    return rs\r\n}","\r\nimport { ShareActionType, ShareActionTypes } from \"./type\";\r\n\r\nexport function ToggleLoading(data: boolean): ShareActionTypes {\r\n    return {\r\n      type: ShareActionType.TOGGLE_LOADING,\r\n      payload: data\r\n    }\r\n}","import { User } from \"../../interface/user\";\r\n\r\nexport enum AuthActionType {\r\n    SET_USER = \"SET_USER\",\r\n    UPDATE_USER = \"UPDATE_USER\",\r\n    SET_LOGIN = \"SET_LOGIN\"\r\n}\r\n\r\ninterface UpdatePayload {\r\n    Id : string,\r\n    user : User\r\n}\r\n\r\nexport interface SetUserAction {\r\n    type: typeof AuthActionType.SET_USER\r\n    payload: User\r\n}\r\n\r\nexport interface UpdatetUserAction {\r\n    type: typeof AuthActionType.UPDATE_USER\r\n    payload: UpdatePayload\r\n}\r\n\r\nexport interface SetLoginStateAction {\r\n    type: typeof AuthActionType.SET_LOGIN\r\n    payload: boolean\r\n}\r\n\r\n  \r\nexport type AuthActionTypes = SetUserAction | UpdatetUserAction | SetLoginStateAction","import { Project } from \"../../interface/project\";\r\n\r\nexport enum ProjectActionType {\r\n    SET_PROJECT = \"SET_PROJECT\",\r\n    UPDATE_PROJECT = \"UPDATE_PROJECT\",\r\n    NEW_PROJECT = \"NEW_PROJECT\",\r\n    DELETE_PROJECT = \"DELETE_PROJECT\",\r\n    TOGGLE_MODAL = \"TOGGLE_MODAL\",\r\n    TOGGLE_CONFRIM_MODAL = \"TOGGLE_CONFRIM_MODAL\"\r\n}\r\n\r\ninterface SetProjectAction {\r\n    type: typeof ProjectActionType.SET_PROJECT\r\n    payload: Project[]\r\n}\r\n\r\ninterface UpdateProjectAction {\r\n    type: typeof ProjectActionType.UPDATE_PROJECT\r\n    payload: Project\r\n}\r\n\r\ninterface NewProjectAction {\r\n    type : typeof ProjectActionType.NEW_PROJECT,\r\n    payload : Project\r\n}\r\n\r\ninterface DeleteProjectAction {\r\n    type : typeof ProjectActionType.DELETE_PROJECT,\r\n    payload : string\r\n}\r\n\r\ninterface ToggleAddModal{\r\n    type : typeof ProjectActionType.TOGGLE_MODAL,\r\n    payload : boolean\r\n}\r\n\r\ninterface ToggleConfrimModal{\r\n    type : typeof ProjectActionType.TOGGLE_CONFRIM_MODAL,\r\n    payload : boolean\r\n}\r\n\r\n  \r\nexport type ProjectActionTypes = SetProjectAction  | UpdateProjectAction | NewProjectAction | \r\nDeleteProjectAction | ToggleAddModal | ToggleConfrimModal","import { TableData } from \"../components/TableEditor\";\r\nimport { DiagramController } from \"../DiagramController/DiagramCtr\";\r\nimport { SchemaNodeModel } from \"../schemanode/node/SchemaNodeModel\";\r\n\r\nfunction getAllTable(diagram : DiagramController) : TableData[]{\r\n    let rs : TableData[] = []\r\n    let alltb = diagram.getEngine().getModel().getNodes() as SchemaNodeModel[]\r\n    alltb.forEach(tb => {\r\n      let name =tb.getOptions().name\r\n      if(name == undefined) name = \"\"\r\n      let add : TableData = {\r\n        id : tb.getID(),\r\n        tablename : name,\r\n        fields : tb.getAllField()\r\n      }\r\n      rs.push(add)\r\n    });\r\n    return rs\r\n}\r\n\r\nexport {getAllTable}","import Cookies from 'js-cookie'\r\n\r\nexport interface User{\r\n    Id : string,\r\n    UserName : string,\r\n    UserLastName : string,\r\n    UserEmail : string,\r\n    UserPassword : string\r\n}\r\n\r\nexport function defaultUser() : User{\r\n    \r\n    let rs : User = {\r\n        Id : \"\",\r\n        UserName : \"test\",\r\n        UserLastName :  \"\",\r\n        UserEmail : \"\",\r\n        UserPassword : \"\"\r\n    }\r\n    return rs\r\n}\r\n\r\nexport function isLogin() : boolean{\r\n    const token = Cookies.get(\"ertoken\")\r\n    alert(\"call login check in file :src/interface/user.isLogin\")\r\n        if(token !== \"\" && token !== undefined){\r\n            //pass login\r\n            return true\r\n        }\r\n    return false\r\n}\r\n\r\nexport function jsonToUser(d : any) : User{\r\n    const rs : User = {\r\n        Id : d._id,\r\n        UserName : d.userName,\r\n        UserLastName : d.userlastname,\r\n        UserEmail : d.userEmail,\r\n        UserPassword : d.userPassword\r\n    }\r\n    return rs\r\n}","import { User } from \"../../interface/user\";\r\nimport { AuthActionType, AuthActionTypes } from \"./type\";\r\n\r\nexport function SetUser(user: User): AuthActionTypes {\r\n    return {\r\n      type: AuthActionType.SET_USER,\r\n      payload: user\r\n    }\r\n}\r\n\r\nexport function SetLoginState(data:boolean): AuthActionTypes {\r\n  return {\r\n    type: AuthActionType.SET_LOGIN,\r\n    payload: data\r\n  }\r\n}","\r\nimport { Project } from \"../../interface/project\";\r\nimport { ProjectActionType, ProjectActionTypes } from \"./type\";\r\n\r\nexport function SetProject(data: Project[]): ProjectActionTypes {\r\n    return {\r\n      type: ProjectActionType.SET_PROJECT,\r\n      payload: data\r\n    }\r\n}\r\n\r\nexport function NewProject(data: Project): ProjectActionTypes {\r\n  return {\r\n    type: ProjectActionType.NEW_PROJECT,\r\n    payload: data\r\n  }\r\n}\r\n\r\nexport function DeleteProject(id : string) : ProjectActionTypes{\r\n  return {\r\n    type : ProjectActionType.DELETE_PROJECT,\r\n    payload : id\r\n  }\r\n}\r\n\r\nexport function ToggleModal(value : boolean) : ProjectActionTypes{\r\n  return {\r\n    type : ProjectActionType.TOGGLE_MODAL,\r\n    payload : value\r\n  }\r\n}\r\n\r\nexport function ToggleConfrimModal(value : boolean) : ProjectActionTypes{\r\n  return {\r\n    type : ProjectActionType.TOGGLE_CONFRIM_MODAL,\r\n    payload : value\r\n  }\r\n}","import axios from \"axios\";\r\nimport { Dispatch } from \"redux\";\r\nimport { LoginPayload } from \"../../interface/loginpayload\"\r\nimport { User , defaultUser , jsonToUser } from \"../../interface/user\";\r\nimport {SetLoginState, SetUser} from './action'\r\nimport Cookies from \"js-cookie\"\r\nimport { SetProject } from \"../project/action\";\r\nimport {initApp} from '../loadapp'\r\nexport const signIn = (login : LoginPayload) => {\r\n    return async (dispatch : Dispatch) => {\r\n      let url = \"https://toperbackend.herokuapp.com/auth/login\"\r\n     \r\n      let rs = await axios.post(url , login)\r\n      if(rs.status === 200){\r\n        const data = rs.data\r\n        if(data.access_token !== \"\"){\r\n            Cookies.set(\"ertoken\" , data.access_token)\r\n            const user : User = jsonToUser(data)\r\n            dispatch(SetUser(user))\r\n            dispatch(SetLoginState(true))\r\n  \r\n        }\r\n        \r\n      }\r\n      \r\n    };\r\n}\r\n\r\nexport const signOut = () => {\r\n  return (dispatch : Dispatch) => {\r\n    Cookies.set(\"ertoken\" , \"\")\r\n    const user : User = defaultUser()\r\n    dispatch(SetUser(user))\r\n    dispatch(SetLoginState(false))\r\n    dispatch(SetProject([]))\r\n  };\r\n}\r\n\r\nexport const fetchPosts = (loginPayload : LoginPayload) => async (dispatch : any) => {\r\n\r\n    dispatch({ type: 'FETCH_POSTS', payload: \"\" })\r\n}\r\n\r\n","import axios from \"axios\";\r\nimport { Dispatch } from \"redux\";\r\nimport Cookies from \"js-cookie\"\r\nimport { ToggleLoading } from \"./share/action\";\r\nimport { jsonToProject, Project } from \"../interface/project\";\r\nimport { jsonToUser } from \"../interface/user\";\r\nimport { SetLoginState, SetUser } from \"./auth/action\";\r\nimport { SetProject } from \"./project/action\";\r\n\r\nexport const initApp = () => {\r\n\r\n    return async (dispatch : Dispatch) => {\r\n\r\n      let baseUrl = \"https://toperbackend.herokuapp.com\"\r\n      let userUrl = baseUrl + \"/user/getuser\"\r\n      let projectUrl = baseUrl + \"/project/getprojects\"\r\n\r\n      let token = Cookies.get(\"ertoken\")\r\n\r\n      if(token === \"\" || token === undefined){\r\n            dispatch(ToggleLoading(false))\r\n            dispatch(SetLoginState(false))\r\n            alert('please login')\r\n            return\r\n      }\r\n\r\n      dispatch(ToggleLoading(true))\r\n\r\n      axios.defaults.headers.common['Authorization'] = \"Bearer \" + token\r\n\r\n      axios.all([\r\n        axios.get(userUrl), \r\n        axios.get(projectUrl)\r\n      ])\r\n      .then(axios.spread((userrs, projectrs) => {\r\n\r\n        dispatch(ToggleLoading(false))\r\n\r\n        if(userrs.data.length > 0){\r\n            let userdata = userrs.data[0]\r\n            const user = jsonToUser(userdata)\r\n            dispatch(SetUser(user))\r\n            dispatch(SetLoginState(true))\r\n        }\r\n        let projects : Project[] = []\r\n        projectrs.data.forEach((p : any) =>{\r\n            const project : Project = jsonToProject(p)\r\n            projects.push(project)\r\n        })\r\n\r\n        dispatch(SetProject(projects))\r\n\r\n      }));      \r\n      \r\n    };\r\n}","import React, { FunctionComponent, useState } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { Button, Checkbox, Form, Modal } from 'semantic-ui-react'\r\nimport { LoginPayload } from '../../interface/loginpayload'\r\n\r\nimport { defaultUser } from '../../interface/user'\r\n\r\nimport { signIn, signOut } from '../../reducer/auth/thunkaction'\r\n\r\nimport { initApp } from '../../reducer/loadapp'\r\n\r\ninterface LoginModalProp {\r\n    isLogin: boolean\r\n}\r\n\r\nexport const LoginModal: FunctionComponent<LoginModalProp> = ({ isLogin }) => {\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const [userName, setuserName] = useState(\"\")\r\n\r\n    const [userPassword, setuserPassword] = useState(\"\")\r\n\r\n    const onLogin = async () => {\r\n        let loginParam: LoginPayload = {\r\n            userName: userName,\r\n            userPassword: userPassword\r\n        }\r\n        await dispatch(signIn(loginParam))\r\n        dispatch(initApp())\r\n    }\r\n\r\n\r\n    return (\r\n        <Modal\r\n            open={!isLogin}\r\n            header='Sign In'\r\n        >\r\n            <Form>\r\n                <Form.Field>\r\n                    <label>First Name</label>\r\n                    <input placeholder=\"Enter name\" onChange={(e) => setuserName(e.target.value)} value={userName} />\r\n                </Form.Field>\r\n                <Form.Field>\r\n                    <label>Last Name</label>\r\n                    <input placeholder=\"Enter password\" onChange={(e) => setuserPassword(e.target.value)} value={userPassword} />\r\n                </Form.Field>\r\n                <Form.Field>\r\n                    <Checkbox label='I agree to the Terms and Conditions' />\r\n                </Form.Field>\r\n                <Button type='submit' onClick={onLogin}>Submit</Button>\r\n            </Form>\r\n        </Modal>\r\n\r\n    )\r\n\r\n}\r\n\r\n\r\nexport default LoginModal","import React, { FunctionComponent } from 'react'\r\nimport {  useDispatch, useSelector } from 'react-redux'\r\nimport { Button, Container, Menu , Image} from 'semantic-ui-react';\r\nimport { signOut } from '../../reducer/auth/thunkaction';\r\n\r\nimport {RootState} from '../../store/index'\r\n\r\nimport Logo from '../Icons/ericon.png'\r\n\r\nexport const MainHead: FunctionComponent = () => {\r\n\r\n    const user = useSelector((state: RootState) => state.AuthReducer.user);\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const onLogOut = () => {\r\n        dispatch(signOut())\r\n    }\r\n\r\n    return (\r\n        <Menu fixed='top' >\r\n  \r\n          <Menu.Item as='a' header>\r\n            <Image size='mini' src={Logo} style={{ marginRight: '1.5em' }} />\r\n            Top Diagram\r\n          </Menu.Item>\r\n          <Menu.Item as='a'>Home</Menu.Item>\r\n  \r\n          <Menu.Item position='right'>\r\n                  <Button as='a' >\r\n                    {user.UserName}\r\n                  </Button>\r\n                  <Button as='a' style={{ marginLeft: '0.5em' }} onClick={onLogOut}>\r\n                    Sign Up\r\n                  </Button>\r\n                </Menu.Item>\r\n   \r\n      </Menu>\r\n\r\n    )\r\n\r\n}\r\n\r\n\r\nexport default MainHead\r\n","export default \"data:image/png;base64,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\"","import React, { FunctionComponent, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { Link } from 'react-router-dom'\r\nimport { Button, Header, Icon, List, Modal } from 'semantic-ui-react'\r\nimport { Project } from '../../interface/project'\r\nimport { deleteProjectAsync } from '../../reducer/project/thunkaction'\r\nimport { RootState } from '../../store'\r\n\r\n\r\nexport const FileList: FunctionComponent = () => {\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const [isConfrimModal, setisConfrimModal] = useState(false)\r\n\r\n    const [currentSelect, setcurrentSelect] = useState(\"\")\r\n\r\n    const projects = useSelector((state: RootState) => state.ProjectReducer.projects)\r\n\r\n    const selectRemove = (id: string | undefined) => {\r\n        if (id === undefined) id = \"\"\r\n        setisConfrimModal(true)\r\n        setcurrentSelect(id)\r\n    }\r\n\r\n    const confrimRemove = () => {\r\n        alert(currentSelect)\r\n        setisConfrimModal(false)\r\n        if(currentSelect === \"\") return\r\n        dispatch(deleteProjectAsync(currentSelect))\r\n    }\r\n\r\n\r\n    return (\r\n\r\n        <List divided relaxed>\r\n            {projects.map((p: Project) => (\r\n                <List.Item key={p.Id}>\r\n                    <List.Icon name='file' size='large' verticalAlign='middle' />\r\n                    <List.Content floated='left'>\r\n                        <Link to={`/editor/${p.Id}`}>\r\n                            <List.Header as='a'>{p.ProjectName}</List.Header>\r\n                        </Link>\r\n                        <List.Description as='a'>Updated 10 mins ago</List.Description>\r\n                    </List.Content>\r\n\r\n                    <Button color=\"blue\" onClick={() => selectRemove(p.Id)}>Remove</Button>\r\n\r\n                </List.Item>\r\n            ))}\r\n            <Modal\r\n                basic\r\n                onClose={() => setisConfrimModal(false)}\r\n                onOpen={() => setisConfrimModal(true)}\r\n                open={isConfrimModal}\r\n                size='small'\r\n\r\n            >\r\n                <Header icon>\r\n                    <Icon name='archive' />\r\n        Archive Old Messages\r\n      </Header>\r\n                <Modal.Content>\r\n                    <p>\r\n                        Your inbox is getting full, would you like us to enable automatic\r\n                        archiving of old messages?\r\n        </p>\r\n                </Modal.Content>\r\n                <Modal.Actions>\r\n                    <Button basic color='red' inverted onClick={() => setisConfrimModal(false)}>\r\n                        <Icon name='remove' /> No\r\n        </Button>\r\n                    <Button color='green' inverted onClick={confrimRemove}>\r\n                        <Icon name='checkmark' /> Yes\r\n        </Button>\r\n                </Modal.Actions>\r\n            </Modal>\r\n        </List>\r\n\r\n    )\r\n\r\n}\r\n\r\n\r\nexport default FileList","import axios from \"axios\";\r\nimport { Dispatch } from \"redux\";\r\nimport { LoginPayload } from \"../../interface/loginpayload\"\r\nimport { Project, projectToJson } from \"../../interface/project\";\r\nimport { User , defaultUser , jsonToUser } from \"../../interface/user\";\r\nimport { ToggleLoading } from \"../share/action\";\r\nimport { DeleteProject, NewProject, ToggleModal } from \"./action\";\r\n\r\nexport const newProjectAsync = (project : Project) => {\r\n    return async (dispatch : Dispatch) => {\r\n        let url = \"https://toperbackend.herokuapp.com/project\"\r\n        let data = projectToJson(project)\r\n        alert(JSON.stringify(data))\r\n        dispatch(ToggleModal(false))\r\n        dispatch(ToggleLoading(true))\r\n        const rs = await axios.post(url , data)\r\n        if(rs.status === 200){\r\n            dispatch(NewProject(project))\r\n\r\n        }\r\n        dispatch(ToggleLoading(false))\r\n    };\r\n  }\r\n\r\n  export const deleteProjectAsync = (id : string) => {\r\n    return async (dispatch : Dispatch) => {\r\n        let url = \"https://toperbackend.herokuapp.com/project/delete/\" + id \r\n        dispatch(ToggleLoading(true))\r\n        const rs = await axios.delete(url)\r\n        if(rs.status === 200){\r\n            dispatch(DeleteProject(id))\r\n        }\r\n        dispatch(ToggleLoading(false))\r\n    };\r\n  }\r\n\r\nexport const fetchPosts = (loginPayload : LoginPayload) => async (dispatch : any) => {\r\n\r\n    dispatch({ type: 'FETCH_POSTS', payload: \"\" })\r\n}\r\n\r\n","import React ,  { FunctionComponent, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Button, Form, Modal } from \"semantic-ui-react\";\r\nimport { Project } from \"../../interface/project\";\r\nimport { newProjectAsync } from \"../../reducer/project/thunkaction\";\r\nimport { RootState } from \"../../store\";\r\n\r\ninterface ProjectForm {\r\n    isOpen : boolean\r\n}\r\n\r\nexport const ProjectForm: FunctionComponent<ProjectForm> = ({isOpen}) => {\r\n\r\n    const [projectName, setprojectName] = useState(\"\")\r\n\r\n    const [projectDescription, setprojectDescription] = useState(\"\")\r\n\r\n    const user = useSelector((state : RootState) => state.AuthReducer.user)\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const onSave = () => {\r\n        let project : Project = {\r\n            ProjectName : projectName,\r\n            ProjectDescription : projectDescription,\r\n            ProjectDetail : \"\",\r\n            VisibleStatus : 1,\r\n            UserId :  user.Id,\r\n            ShareUrl : \"\"\r\n        }\r\n        dispatch(newProjectAsync(project))\r\n    }\r\n\r\n        return (\r\n            <Modal open={isOpen}>\r\n                <Form>\r\n                <input type=\"text\" placeholder=\"Project name\" value={projectName} \r\n                onChange={(e) => setprojectName(e.target.value)} />\r\n                <input type=\"text\" placeholder=\"Project Description\" value={projectDescription}\r\n                onChange={(e) => setprojectDescription(e.target.value)} />\r\n                <Button onClick={onSave}>Save</Button>\r\n            </Form>\r\n            </Modal>\r\n            \r\n        )\r\n\r\n\r\n    \r\n}","import React, { FunctionComponent, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Route, Switch } from \"react-router-dom\";\r\nimport LoginModal from \"../components/Document/LoginModal\";\r\nimport { MainHead } from \"../components/Document/MainHead\";\r\nimport { RootState } from \"../store\";\r\nimport { initApp } from \"../reducer/loadapp\";\r\nimport {\r\n  Button,\r\n  Header,\r\n  Icon,\r\n  Loader,\r\n  Menu,\r\n  Segment,\r\n  Sidebar,\r\n} from \"semantic-ui-react\";\r\nimport { FileList } from \"../components/Document/FileList\";\r\nimport { ToggleModal } from \"../reducer/project/action\";\r\nimport { ProjectForm } from \"../components/Document/ProjectForm\";\r\n\r\nexport default function ExTemplate() {\r\n  return <div>Template</div>;\r\n}\r\n\r\nexport const Document: FunctionComponent = () => {\r\n  const isLogin = useSelector((state: RootState) => state.AuthReducer.isLogin);\r\n\r\n  const addProjectModal = useSelector((state: RootState) => state.ProjectReducer.addProjectModal)\r\n\r\n  const isLoading = useSelector(\r\n    (state: RootState) => state.ShareReducer.isLoading\r\n  );\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    dispatch(initApp());\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <Loader active={isLoading} />\r\n      <MainHead />\r\n      <Sidebar.Pushable as={Segment} style={{ marginTop: 55, height: \"95vh\" }}>\r\n        <Sidebar\r\n          as={Menu}\r\n          direction={\"left\"}\r\n          size=\"large\"\r\n          vertical\r\n          visible={true}\r\n          style={{ marginTop: 50 }}\r\n        >\r\n          <Menu.Item name=\"add\">\r\n            <Button onClick={() => dispatch(ToggleModal(true))}>New Project</Button>\r\n          </Menu.Item>\r\n          <Menu.Item name=\"home\">\r\n            <Icon name=\"home\" />\r\n            Home\r\n          </Menu.Item>\r\n          <Menu.Item name=\"template\">\r\n            <Icon name=\"folder\" />\r\n            Template\r\n          </Menu.Item>\r\n          <Menu.Item name=\"accout\">\r\n            <Icon name=\"folder\" />\r\n            Accout\r\n          </Menu.Item>\r\n        </Sidebar>\r\n\r\n        <Sidebar.Pusher>\r\n          <Segment basic>\r\n            <Switch>\r\n              <Route path=\"/document/filelist\" component={FileList} />\r\n              <Route path=\"/document/template\" component={ExTemplate} />\r\n            </Switch>\r\n          </Segment>\r\n        </Sidebar.Pusher>\r\n      </Sidebar.Pushable>\r\n\r\n      <LoginModal isLogin={isLogin} />\r\n      <ProjectForm isOpen={addProjectModal} />\r\n    </div>\r\n  );\r\n};\r\n","import React, { FunctionComponent, useEffect, useState } from 'react'\r\n\r\n\r\n\r\nimport {BrowserRouter as Router, Redirect, Route } from 'react-router-dom'\r\n\r\nimport { Editor } from './pages/editor'\r\n\r\nimport {Document} from './pages/document'\r\n\r\nimport 'semantic-ui-css/semantic.min.css'\r\n\r\nexport const App: FunctionComponent = () => {\r\n\r\n\treturn (\r\n\t\t<React.Fragment>\r\n\t\t\t<Router>\r\n\r\n\t\t\t<Route exact path=\"/\" component={Document} >\r\n\t\t\t\t<Redirect to=\"/document/filelist\" />\r\n\t\t\t</Route>\r\n\t\t\t<Route  path=\"/document\" component={Document} />\r\n\t\t\t<Route exact path=\"/editor/:projectId\" component={Editor} />\r\n\r\n\t\t\t</Router>\r\n\r\n\t\t\t\r\n\r\n\t\t</React.Fragment>\r\n\r\n\t);\r\n\r\n}\r\n\r\n\r\n\r\n","import { User , defaultUser, isLogin } from \"../../interface/user\"\r\nimport { AuthActionType , AuthActionTypes} from './type'\r\n\r\n\r\nexport interface AuthState {\r\n    user : User,\r\n    isLogin : boolean,\r\n    err : string\r\n}\r\n\r\nconst initialState : AuthState = {\r\n    user : defaultUser(),\r\n    isLogin : true,\r\n    err : \"no err\"\r\n}\r\n\r\nexport const AuthReducer =  (state  = initialState, action : AuthActionTypes) => {\r\n    switch (action.type) {\r\n\r\n    case AuthActionType.SET_USER:\r\n        return { ...state, user : action.payload }\r\n    case AuthActionType.UPDATE_USER:\r\n        return { ...state, ...action.payload }\r\n    case AuthActionType.SET_LOGIN:\r\n        return { ...state, isLogin : action.payload }\r\n    \r\n    default:\r\n        return state\r\n    }\r\n}\r\n","\r\nimport { ShareActionTypes , ShareActionType } from './type'\r\n\r\ninterface ShareState {\r\n    error : string,\r\n    isLoading : boolean,\r\n}\r\n\r\nconst initialState : ShareState = {\r\n    error : \"\",\r\n    isLoading : false,\r\n}\r\n\r\nexport const ShareReducer =  (state = initialState, action : ShareActionTypes) => {\r\n    switch (action.type) {\r\n\r\n    case ShareActionType.TOGGLE_LOADING:\r\n        return { ...state, isLoading : action.payload }\r\n\r\n    default:\r\n        return state\r\n    }\r\n}\r\n","\r\nimport { Project , defaultProjects  , defaultProject } from \"../../interface/project\"\r\nimport { ProjectActionTypes , ProjectActionType } from \"./type\"\r\n\r\ninterface ProjectState {\r\n    projects : Project[],\r\n    currentProject : Project,\r\n    addProjectModal : boolean,\r\n    confrimModal : boolean\r\n}\r\n\r\nconst initialState : ProjectState = {\r\n    projects : defaultProjects(),\r\n    currentProject : defaultProject(),\r\n    addProjectModal : false,\r\n    confrimModal : false\r\n}\r\n\r\nexport const ProjectReducer = (state = initialState, action : ProjectActionTypes) => {\r\n    switch (action.type) {\r\n\r\n    case ProjectActionType.SET_PROJECT:\r\n        return { ...state, projects : action.payload }\r\n    case ProjectActionType.NEW_PROJECT:\r\n        state.projects.push(action.payload)\r\n        return { ...state }\r\n    case ProjectActionType.DELETE_PROJECT:\r\n        const indexof = state.projects.findIndex(p=>p.Id === action.payload)\r\n        if(indexof !== -1) state.projects.splice(indexof , 1)\r\n        return { ...state }\r\n    case ProjectActionType.TOGGLE_MODAL:\r\n        return { ...state , addProjectModal : action.payload }\r\n    case ProjectActionType.TOGGLE_CONFRIM_MODAL:\r\n        return { ...state , confrimModal : action.payload }\r\n\r\n    default:\r\n        return state\r\n    }\r\n}\r\n","import { createStore, combineReducers , applyMiddleware } from \"redux\";\r\n\r\nimport {AuthReducer} from \"../reducer/auth/auth\";\r\n\r\nimport {ShareReducer} from '../reducer/share/share'\r\n\r\nimport {ProjectReducer} from '../reducer/project/project'\r\n\r\nimport thunkMiddleware from 'redux-thunk'\r\n\r\nconst rootReducer = combineReducers({\r\n\tAuthReducer,\r\n    ShareReducer,\r\n    ProjectReducer\r\n});\r\n\r\nexport type RootState = ReturnType<typeof rootReducer>;\r\n\r\nconst store = () => {\r\n\t return\tcreateStore(rootReducer , applyMiddleware(thunkMiddleware));\r\n}\r\n\r\nexport default store","\n\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {App} from './App'\nimport './index.css';\n\nimport { Provider } from 'react-redux';\nimport configureStore from \"./store/index\";\n\nconst store = configureStore();\n\n\nReactDOM.render(   \n  <Provider store={store}>\n\t\t<App />\n\t</Provider>\n  \n,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}